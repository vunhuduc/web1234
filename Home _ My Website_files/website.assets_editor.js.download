
/* /website/static/lib/jQuery.transfo.js defined in bundle 'website.assets_editor' */
(function($){'use strict';var rad=Math.PI/180;var methods={init:function(settings){return this.each(function(){var $this=$(this),transfo=$this.data('transfo');if(!transfo){_init($this,settings);}else{_overwriteOptions($this,transfo,settings);_targetCss($this,transfo);}});},destroy:function(){return this.each(function(){var $this=$(this);if($this.data('transfo')){_destroy($this);}});},reset:function(){return this.each(function(){var $this=$(this);if($this.data('transfo')){_reset($this);}});},toggle:function(){return this.each(function(){var $this=$(this);var transfo=$this.data('transfo');if(transfo){transfo.settings.hide=!transfo.settings.hide;_showHide($this,transfo);}});},hide:function(){return this.each(function(){var $this=$(this);var transfo=$this.data('transfo');if(transfo){transfo.settings.hide=true;_showHide($this,transfo);}});},show:function(){return this.each(function(){var $this=$(this);var transfo=$this.data('transfo');if(transfo){transfo.settings.hide=false;_showHide($this,transfo);}});},settings:function(){if(this.length>1){this.map(function(){var $this=$(this);return $this.data('transfo')&&$this.data('transfo').settings;});}
return this.data('transfo')&&$this.data('transfo').settings;},center:function(){if(this.length>1){this.map(function(){var $this=$(this);return $this.data('transfo')&&$this.data('transfo').$center.offset();});}
return this.data('transfo')&&this.data('transfo').$center.offset();}};$.fn.transfo=function(method){if(methods[method]){return methods[method].apply(this,Array.prototype.slice.call(arguments,1));}else if(typeof method==='object'||!method){return methods.init.apply(this,arguments);}else{$.error('Method '+method+' does not exist on jQuery.transfo');}
return false;};function _init($this,settings){var transfo={};$this.data('transfo',transfo);transfo.settings=settings;var css="box-sizing: border-box; position: absolute; background-color: #fff; border: 1px solid #ccc; width: 8px; height: 8px; margin-left: -4px; margin-top: -4px;";transfo.$markup=$(''
+'<div class="transfo-container">'
+'<div class="transfo-controls">'
+'<div style="cursor: crosshair; position: absolute; margin: -30px; top: 0; right: 0; padding: 1px 0 0 1px;" class="transfo-rotator">'
+'<span class="fa-stack fa-lg">'
+'<i class="fa fa-circle fa-stack-2x"></i>'
+'<i class="fa fa-repeat fa-stack-1x fa-inverse"></i>'
+'</span>'
+'</div>'
+'<div style="'+css+'top: 0%; left: 0%; cursor: nw-resize;" class="transfo-scaler-tl"></div>'
+'<div style="'+css+'top: 0%; left: 100%; cursor: ne-resize;" class="transfo-scaler-tr"></div>'
+'<div style="'+css+'top: 100%; left: 100%; cursor: se-resize;" class="transfo-scaler-br"></div>'
+'<div style="'+css+'top: 100%; left: 0%; cursor: sw-resize;" class="transfo-scaler-bl"></div>'
+'<div style="'+css+'top: 0%; left: 50%; cursor: n-resize;" class="transfo-scaler-tc"></div>'
+'<div style="'+css+'top: 100%; left: 50%; cursor: s-resize;" class="transfo-scaler-bc"></div>'
+'<div style="'+css+'top: 50%; left: 0%; cursor: w-resize;" class="transfo-scaler-ml"></div>'
+'<div style="'+css+'top: 50%; left: 100%; cursor: e-resize;" class="transfo-scaler-mr"></div>'
+'<div style="'+css+'border: 0; width: 0px; height: 0px; top: 50%; left: 50%;" class="transfo-scaler-mc"></div>'
+'</div>'
+'</div>');transfo.$center=transfo.$markup.find(".transfo-scaler-mc");_setOptions($this,transfo);_overwriteOptions($this,transfo,settings);$("body").append(transfo.$markup);setTimeout(function(){_targetCss($this,transfo);},0);_bind($this,transfo);_targetCss($this,transfo);_stop_animation($this[0]);}
function _overwriteOptions($this,transfo,settings){transfo.settings=$.extend(transfo.settings,settings||{});}
function _stop_animation(target){target.style.webkitAnimationPlayState="paused";target.style.animationPlayState="paused";target.style.webkitTransition="none";target.style.transition="none";}
function _setOptions($this,transfo){var style=$this.attr("style")||"";var transform=style.match(/transform\s*:([^;]+)/)?style.match(/transform\s*:([^;]+)/)[1]:"";transfo.settings={};transfo.settings.angle=transform.indexOf('rotate')!=-1?parseFloat(transform.match(/rotate\(([^)]+)deg\)/)[1]):0;transfo.settings.scalex=transform.indexOf('scaleX')!=-1?parseFloat(transform.match(/scaleX\(([^)]+)\)/)[1]):1;transfo.settings.scaley=transform.indexOf('scaleY')!=-1?parseFloat(transform.match(/scaleY\(([^)]+)\)/)[1]):1;transfo.settings.style=style.replace(/[^;]*transform[^;]+/g,'').replace(/;+/g,';');$this.attr("style",transfo.settings.style);_stop_animation($this[0]);transfo.settings.pos=$this.offset();transfo.settings.height=$this.innerHeight();transfo.settings.width=$this.innerWidth();var translatex=transform.match(/translateX\(([0-9.-]+)(%|px)\)/);var translatey=transform.match(/translateY\(([0-9.-]+)(%|px)\)/);transfo.settings.translate="%";if(translatex&&translatex[2]==="%"){transfo.settings.translatexp=parseFloat(translatex[1]);transfo.settings.translatex=transfo.settings.translatexp/100*transfo.settings.width;}else{transfo.settings.translatex=translatex?parseFloat(translatex[1]):0;}
if(translatey&&translatey[2]==="%"){transfo.settings.translateyp=parseFloat(translatey[1]);transfo.settings.translatey=transfo.settings.translateyp/100*transfo.settings.height;}else{transfo.settings.translatey=translatey?parseFloat(translatey[1]):0;}
transfo.settings.css=window.getComputedStyle($this[0],null);transfo.settings.rotationStep=5;transfo.settings.hide=false;transfo.settings.callback=function(){};}
function _bind($this,transfo){function mousedown(event){_mouseDown($this,this,transfo,event);$(document).on("mousemove",mousemove).on("mouseup",mouseup);}
function mousemove(event){_mouseMove($this,this,transfo,event);}
function mouseup(event){_mouseUp($this,this,transfo,event);$(document).off("mousemove",mousemove).off("mouseup",mouseup);}
transfo.$markup.off().on("mousedown",mousedown);transfo.$markup.find(".transfo-controls >:not(.transfo-scaler-mc)").off().on("mousedown",mousedown);}
function _mouseDown($this,div,transfo,event){event.preventDefault();if(transfo.active||event.which!==1)return;var type="position",$e=$(div);if($e.hasClass("transfo-rotator"))type="rotator";else if($e.hasClass("transfo-scaler-tl"))type="tl";else if($e.hasClass("transfo-scaler-tr"))type="tr";else if($e.hasClass("transfo-scaler-br"))type="br";else if($e.hasClass("transfo-scaler-bl"))type="bl";else if($e.hasClass("transfo-scaler-tc"))type="tc";else if($e.hasClass("transfo-scaler-bc"))type="bc";else if($e.hasClass("transfo-scaler-ml"))type="ml";else if($e.hasClass("transfo-scaler-mr"))type="mr";transfo.active={"type":type,"scalex":transfo.settings.scalex,"scaley":transfo.settings.scaley,"pageX":event.pageX,"pageY":event.pageY,"center":transfo.$center.offset(),};}
function _mouseUp($this,div,transfo,event){transfo.active=null;}
function _mouseMove($this,div,transfo,event){event.preventDefault();if(!transfo.active)return;var settings=transfo.settings;var center=transfo.active.center;var cdx=center.left-event.pageX;var cdy=center.top-event.pageY;if(transfo.active.type=="rotator"){var ang,dang=Math.atan((settings.width*settings.scalex)/(settings.height*settings.scaley))/rad;if(cdy)ang=Math.atan(-cdx/cdy)/rad;else ang=0;if(event.pageY>=center.top&&event.pageX>=center.left)ang+=180;else if(event.pageY>=center.top&&event.pageX<center.left)ang+=180;else if(event.pageY<center.top&&event.pageX<center.left)ang+=360;ang-=dang;if(settings.scaley<0&&settings.scalex<0)ang+=180;if(!event.ctrlKey){settings.angle=Math.round(ang/transfo.settings.rotationStep)*transfo.settings.rotationStep;}else{settings.angle=ang;}
_targetCss($this,transfo);var new_center=transfo.$center.offset();var x=center.left-new_center.left;var y=center.top-new_center.top;var angle=ang*rad;settings.translatex+=x*Math.cos(angle)-y*Math.sin(-angle);settings.translatey+=-x*Math.sin(angle)+y*Math.cos(-angle);}
else if(transfo.active.type=="position"){var angle=settings.angle*rad;var x=event.pageX-transfo.active.pageX;var y=event.pageY-transfo.active.pageY;transfo.active.pageX=event.pageX;transfo.active.pageY=event.pageY;var dx=x*Math.cos(angle)-y*Math.sin(-angle);var dy=-x*Math.sin(angle)+y*Math.cos(-angle);settings.translatex+=dx;settings.translatey+=dy;}
else if(transfo.active.type.length===2){var angle=settings.angle*rad;var dx=cdx*Math.cos(angle)-cdy*Math.sin(-angle);var dy=-cdx*Math.sin(angle)+cdy*Math.cos(-angle);if(transfo.active.type.indexOf("t")!=-1){settings.scaley=dy/(settings.height/2);}
if(transfo.active.type.indexOf("b")!=-1){settings.scaley=-dy/(settings.height/2);}
if(transfo.active.type.indexOf("l")!=-1){settings.scalex=dx/(settings.width/2);}
if(transfo.active.type.indexOf("r")!=-1){settings.scalex=-dx/(settings.width/2);}
if(settings.scaley>0&&settings.scaley<0.05)settings.scaley=0.05;if(settings.scalex>0&&settings.scalex<0.05)settings.scalex=0.05;if(settings.scaley<0&&settings.scaley>-0.05)settings.scaley=-0.05;if(settings.scalex<0&&settings.scalex>-0.05)settings.scalex=-0.05;if(event.shiftKey&&(transfo.active.type==="tl"||transfo.active.type==="bl"||transfo.active.type==="tr"||transfo.active.type==="br")){settings.scaley=settings.scalex;}}
settings.angle=Math.round(settings.angle);settings.translatex=Math.round(settings.translatex);settings.translatey=Math.round(settings.translatey);settings.scalex=Math.round(settings.scalex*100)/100;settings.scaley=Math.round(settings.scaley*100)/100;_targetCss($this,transfo);_stop_animation($this[0]);return false;}
function _setCss($this,css,settings){var transform="";var trans=false;if(settings.angle!==0){trans=true;transform+=" rotate("+settings.angle+"deg) ";}
if(settings.translatex){trans=true;transform+=" translateX("+(settings.translate==="%"?settings.translatexp+"%":settings.translatex+"px")+") ";}
if(settings.translatey){trans=true;transform+=" translateY("+(settings.translate==="%"?settings.translateyp+"%":settings.translatey+"px")+") ";}
if(settings.scalex!=1){trans=true;transform+=" scaleX("+settings.scalex+") ";}
if(settings.scaley!=1){trans=true;transform+=" scaleY("+settings.scaley+") ";}
if(trans){css+=";"
css+="-webkit-transform:"+transform+";"
+"-moz-transform:"+transform+";"
+"-ms-transform:"+transform+";"
+"-o-transform:"+transform+";"
+"transform:"+transform+";";}
css=css.replace(/(\s*;)+/g,';').replace(/^\s*;|;\s*$/g,'');$this.attr("style",css);}
function _targetCss($this,transfo){var settings=transfo.settings;var width=parseFloat(settings.css.width);var height=parseFloat(settings.css.height);settings.translatexp=Math.round(settings.translatex/width*1000)/10;settings.translateyp=Math.round(settings.translatey/height*1000)/10;_setCss($this,settings.style,settings);transfo.$markup.css({"position":"absolute","width":width+"px","height":height+"px","top":settings.pos.top+"px","left":settings.pos.left+"px"});var $controls=transfo.$markup.find('.transfo-controls');_setCss($controls,"width:"+width+"px;"+"height:"+height+"px;"+"cursor: move;",settings);$controls.children().css("transform","scaleX("+(1/settings.scalex)+") scaleY("+(1/settings.scaley)+")");_showHide($this,transfo);transfo.settings.callback.call($this[0],$this);}
function _showHide($this,transfo){transfo.$markup.css("z-index",transfo.settings.hide?-1:1000);if(transfo.settings.hide){transfo.$markup.find(".transfo-controls > *").hide();transfo.$markup.find(".transfo-scaler-mc").show();}else{transfo.$markup.find(".transfo-controls > *").show();}}
function _destroy($this){$this.data('transfo').$markup.remove();$this.removeData('transfo');}
function _reset($this){var transfo=$this.data('transfo');_destroy($this);$this.transfo(transfo.settings);}})(jQuery);;

/* /website/static/src/js/editor/editor.js defined in bundle 'website.assets_editor' */
odoo.define('website.editor',function(require){'use strict';var weWidgets=require('web_editor.widget');var wUtils=require('website.utils');weWidgets.LinkDialog.include({start:function(){wUtils.autocompleteWithPages(this,this.$('input[name="url"]'));return this._super.apply(this,arguments);},});});;

/* /website/static/src/js/editor/rte.summernote.js defined in bundle 'website.assets_editor' */
odoo.define('website.rte.summernote',function(require){'use strict';var core=require('web.core');require('web_editor.rte.summernote');var eventHandler=$.summernote.eventHandler;var renderer=$.summernote.renderer;var tplIconButton=renderer.getTemplate().iconButton;var _t=core._t;var fn_tplPopovers=renderer.tplPopovers;renderer.tplPopovers=function(lang,options){var $popover=$(fn_tplPopovers.call(this,lang,options));$popover.find('.note-image-popover .btn-group:has([data-value="img-thumbnail"])').append(tplIconButton('fa fa-object-ungroup',{title:_t('Transform the picture (click twice to reset transformation)'),event:'transform',}));return $popover;};$.summernote.pluginEvents.transform=function(event,editor,layoutInfo,sorted){var $selection=layoutInfo.handle().find('.note-control-selection');var $image=$($selection.data('target'));if($image.data('transfo-destroy')){$image.removeData('transfo-destroy');return;}
$image.transfo();var mouseup=function(event){$('.note-popover button[data-event="transform"]').toggleClass('active',$image.is('[style*="transform"]'));};$(document).on('mouseup',mouseup);var mousedown=function(event){if(!$(event.target).closest('.transfo-container').length){$image.transfo('destroy');$(document).off('mousedown',mousedown).off('mouseup',mouseup);}
if($(event.target).closest('.note-popover').length){$image.data('transfo-destroy',true).attr('style',($image.attr('style')||'').replace(/[^;]*transform[\w:]*;?/g,''));}
$image.trigger('content_changed');};$(document).on('mousedown',mousedown);};var fn_boutton_update=eventHandler.modules.popover.button.update;eventHandler.modules.popover.button.update=function($container,oStyle){fn_boutton_update.call(this,$container,oStyle);$container.find('button[data-event="transform"]').toggleClass('active',$(oStyle.image).is('[style*="transform"]')).toggleClass('d-none',!$(oStyle.image).is('img'));};});;

/* /website/static/src/js/editor/snippets.options.js defined in bundle 'website.assets_editor' */
odoo.define('website.snippets.options',function(require){'use strict';var core=require('web.core');var Dialog=require('web.Dialog');var weWidgets=require('web_editor.widget');var options=require('web_editor.snippets.options');var _t=core._t;var qweb=core.qweb;options.Class.include({_refreshAnimations:function($el){this.trigger_up('animation_start_demand',{editableMode:true,$target:$el||this.$target,});},});options.registry.menu_data=options.Class.extend({xmlDependencies:['/website/static/src/xml/website.editor.xml'],onFocus:function(){var self=this;(new Dialog(this,{title:_t("Confirmation"),$content:$(core.qweb.render('website.leaving_current_page_edition')),buttons:[{text:_t("Go to Link"),classes:'btn-primary',click:function(){self.trigger_up('request_save',{reload:false,onSuccess:function(){window.location.href=self.$target.attr('href');},});}},{text:_t("Edit the menu"),classes:'btn-primary',click:function(){this.trigger_up('action_demand',{actionName:'edit_menu',params:[function(){var def=$.Deferred();self.trigger_up('request_save',{onSuccess:def.resolve.bind(def),onFailure:def.reject.bind(def),});return def;},],});}},{text:_t("Stay on this page"),close:true}]})).open();},});options.registry.company_data=options.Class.extend({start:function(){var proto=options.registry.company_data.prototype;var def;var self=this;if(proto.__link===undefined){def=this._rpc({route:'/web/session/get_session_info'}).then(function(session){return self._rpc({model:'res.users',method:'read',args:[session.uid,['company_id']],});}).then(function(res){proto.__link='/web#action=base.action_res_company_form&view_type=form&id='+(res&&res[0]&&res[0].company_id[0]||1);});}
return $.when(this._super.apply(this,arguments),def);},onFocus:function(){var self=this;var proto=options.registry.company_data.prototype;Dialog.confirm(this,_t("Do you want to edit the company data ?"),{confirm_callback:function(){self.trigger_up('request_save',{reload:false,onSuccess:function(){window.location.href=proto.__link;},});},});},});options.registry.carousel=options.Class.extend({start:function(){var self=this;this.$target.carousel({interval:false});this.id=this.$target.attr('id');this.$inner=this.$target.find('.carousel-inner');this.$indicators=this.$target.find('.carousel-indicators');this.$target.carousel('pause');this._rebindEvents();var def=this._super.apply(this,arguments);this.$target.on('slid.bs.carousel',function(){self.$target.carousel('pause');self.trigger_up('option_update',{optionNames:['background','background_position','colorpicker','sizing_y'],name:'target',data:self.$target.find('.carousel-item.active'),});});return def;},onBuilt:function(){this.id='myCarousel'+new Date().getTime();this.$target.attr('id',this.id);this.$target.find('[data-target]').attr('data-target','#'+this.id);this._rebindEvents();},onFocus:function(){this.$target.trigger('slid.bs.carousel');},onClone:function(){var id='myCarousel'+new Date().getTime();this.$target.attr('id',id);this.$target.find('[data-slide]').attr('href','#'+id);this.$target.find('[data-slide-to]').attr('data-target','#'+id);},cleanForSave:function(){this._super.apply(this,arguments);this.$target.find('.carousel-item').removeClass('next prev left right active').first().addClass('active');this.$target.find('.carousel-indicators').find('li').removeClass('active').html('').first().addClass('active');this.$target.removeClass('oe_img_bg '+this._class).css('background-image','');},addSlide:function(previewMode){var self=this;var cycle=this.$inner.find('.carousel-item').length;var $active=this.$inner.find('.carousel-item.active, .carousel-item.prev, .carousel-item.next').first();var index=$active.index();this.$('.carousel-control-prev, .carousel-control-next, .carousel-indicators').removeClass('d-none');this.$indicators.append('<li data-target="#'+this.id+'" data-slide-to="'+cycle+'"></li>');var $clone=$active.clone(true);$clone.removeClass('active').insertAfter($active);_.defer(function(){self.$target.carousel().carousel(++index);self._rebindEvents();});},removeSlide:function(previewMode){if(this.remove_process){return;}
var self=this;var $items=this.$inner.find('.carousel-item');var cycle=$items.length-1;var $active=$items.filter('.active');var index=$active.index();if(cycle>0){this.remove_process=true;this.$target.on('slid.bs.carousel.slide_removal',function(event){$active.remove();self.$indicators.find('li:last').remove();self.$target.off('slid.bs.carousel.slide_removal');self._rebindEvents();self.remove_process=false;if(cycle===1){self.$target.find('.carousel-control-prev, .carousel-control-next, .carousel-indicators').addClass('d-none');}});_.defer(function(){self.trigger_up('animation_start_demand',{editableMode:true,$target:self.$target,});self.$target.carousel(index>0?--index:cycle);});}},interval:function(previewMode,value){this.$target.attr('data-interval',value);},_setActive:function(){this._super.apply(this,arguments);this.$el.find('[data-interval]').removeClass('active').filter('[data-interval='+this.$target.attr('data-interval')+']').addClass('active');},_rebindEvents:function(){var self=this;this.$target.find('.carousel-control-prev, .carousel-control-next').off('click').on('click',function(){self.$target.carousel($(this).data('slide'));});this.$target.find('.carousel-indicators [data-slide-to]').off('click').on('click',function(){self.$target.carousel(+$(this).data('slide-to'));});this.$target.find('.item.text_image, .item.image_text, .item.text_only').find('.container > .carousel-caption > div, .container > img.carousel-image').attr('contentEditable','true');},});options.registry.navTabs=options.Class.extend({start:function(){this._findLinksAndPanes();return this._super.apply(this,arguments);},onBuilt:function(){this._generateUniqueIDs();},onClone:function(){this._generateUniqueIDs();},addTab:function(previewMode,value,$opt){var $activeItem=this.$navLinks.filter('.active').parent();var $activePane=this.$tabPanes.filter('.active');var $navItem=$activeItem.clone();var $navLink=$navItem.find('.nav-link').removeClass('active show');var $tabPane=$activePane.clone().removeClass('active show');$navItem.insertAfter($activeItem);$tabPane.insertAfter($activePane);this._findLinksAndPanes();this._generateUniqueIDs();$navLink.tab('show');},removeTab:function(previewMode,value,$opt){var self=this;var $activeLink=this.$navLinks.filter('.active');var $activePane=this.$tabPanes.filter('.active');var $next=this.$navLinks.eq((this.$navLinks.index($activeLink)+1)%this.$navLinks.length);$next.one('shown.bs.tab',function(){$activeLink.parent().remove();$activePane.remove();self._findLinksAndPanes();self._setActive();});$next.tab('show');},_findLinksAndPanes:function(){this.$navLinks=this.$target.find('.nav-link');var $el=this.$target;do{$el=$el.parent();this.$tabPanes=$el.find('.tab-pane');}while(this.$tabPanes.length===0&&!$el.is('body'));},_generateUniqueIDs:function(){for(var i=0;i<this.$navLinks.length;i++){var id=_.now()+'_'+_.uniqueId();var idLink='nav_tabs_link_'+id;var idContent='nav_tabs_content_'+id;this.$navLinks.eq(i).attr({'id':idLink,'href':'#'+idContent,'aria-controls':idContent,});this.$tabPanes.eq(i).attr({'id':idContent,'aria-labelledby':idLink,});}},_setActive:function(){this._super.apply(this,arguments);this.$el.filter('[data-remove-tab]').toggleClass('d-none',this.$tabPanes.length<=2);},});options.registry.sizing_x=options.registry.sizing.extend({onClone:function(options){this._super.apply(this,arguments);if(options.isCurrent){var _class=this.$target.attr('class').replace(/\s*(offset-xl-|offset-lg-)([0-9-]+)/g,'');this.$target.attr('class',_class);}},_getSize:function(){var width=this.$target.closest('.row').width();var gridE=[1,2,3,4,5,6,7,8,9,10,11,12];var gridW=[0,1,2,3,4,5,6,7,8,9,10,11];this.grid={e:[_.map(gridE,function(v){return'col-lg-'+v;}),_.map(gridE,function(v){return width/12*v;}),'width'],w:[_.map(gridW,function(v){return'offset-lg-'+v;}),_.map(gridW,function(v){return width/12*v;}),'margin-left'],};return this.grid;},_onResize:function(compass,beginClass,current){if(compass==='w'){var beginCol=Number(beginClass.match(/col-lg-([0-9]+)|$/)[1]||0);var beginOffset=Number(beginClass.match(/offset-lg-([0-9-]+)|$/)[1]||beginClass.match(/offset-xl-([0-9-]+)|$/)[1]||0);var offset=Number(this.grid.w[0][current].match(/offset-lg-([0-9-]+)|$/)[1]||0);if(offset<0){offset=0;}
var colSize=beginCol-(offset-beginOffset);if(colSize<=0){colSize=1;offset=beginOffset+beginCol-1;}
this.$target.attr('class',this.$target.attr('class').replace(/\s*(offset-xl-|offset-lg-|col-lg-)([0-9-]+)/g,''));this.$target.addClass('col-lg-'+(colSize>12?12:colSize));if(offset>0){this.$target.addClass('offset-lg-'+offset);}}
this._super.apply(this,arguments);},});options.registry.layout_column=options.Class.extend({selectCount:function(previewMode,value,$opt){this._updateColumnCount(value-this.$target.children().length);},_updateColumnCount:function(count){if(!count){return;}
this.trigger_up('request_history_undo_record',{$target:this.$target});if(count>0){var $lastColumn=this.$target.children().last();for(var i=0;i<count;i++){$lastColumn.clone().insertAfter($lastColumn);}}else{var self=this;_.each(this.$target.children().slice(count),function(el){self.trigger_up('remove_snippet',{$snippet:$(el)});});}
this._resizeColumns();this.trigger_up('cover_update');},_resizeColumns:function(){var $columns=this.$target.children();var colsLength=$columns.length;var colSize=Math.floor(12/colsLength)||1;var colOffset=Math.floor((12-colSize*colsLength)/2);var colClass='col-lg-'+colSize;_.each($columns,function(column){var $column=$(column);$column.attr('class',$column.attr('class').replace(/\b(col|offset)-lg(-\d+)?\b/g,''));$column.addClass(colClass);});if(colOffset){$columns.first().addClass('offset-lg-'+colOffset);}},_setActive:function(){this._super.apply(this,arguments);this.$el.find('[data-select-count]').removeClass('active').filter('[data-select-count='+this.$target.children().length+']').addClass('active');},});options.registry.parallax=options.Class.extend({start:function(){var self=this;this.$target.on('snippet-option-change snippet-option-preview',function(){self._refreshAnimations();});return this._super.apply(this,arguments);},onFocus:function(){this.trigger_up('option_update',{optionNames:['background','background_position'],name:'target',data:this.$target.find('> .s_parallax_bg'),});this._refreshAnimations();},onMove:function(){this._refreshAnimations();},scroll:function(previewMode,value){this.$target.attr('data-scroll-background-ratio',value);this._refreshAnimations();},_setActive:function(){this._super.apply(this,arguments);this.$el.find('[data-scroll]').removeClass('active').filter('[data-scroll="'+(this.$target.attr('data-scroll-background-ratio')||0)+'"]').addClass('active');},});var FacebookPageDialog=weWidgets.Dialog.extend({xmlDependencies:weWidgets.Dialog.prototype.xmlDependencies.concat(['/website/static/src/xml/website.facebook_page.xml']),template:'website.facebook_page_dialog',events:_.extend({},weWidgets.Dialog.prototype.events||{},{'change':'_onOptionChange',}),init:function(parent,fbData,options){this._super(parent,_.extend({title:_t("Facebook Page"),},options||{}));this.fbData=$.extend(true,{},fbData);this.final_data=this.fbData;},start:function(){this.$previewPage=this.$('.o_facebook_page');this.opened().then(this._renderPreview.bind(this));return this._super.apply(this,arguments);},_renderPreview:function(){var self=this;var match=this.fbData.href.match(/^(?:https?:\/\/)?(?:www\.)?(?:fb|facebook)\.com\/(?:([\w.]+)|[^/?#]+-([0-9]{15,16}))(?:$|[\/?# ])/);if(match){$.ajax({url:'https://graph.facebook.com/'+(match[2]||match[1])+'/picture',statusCode:{200:function(){self._toggleWarning(true);if(self.fbData.tabs){self.fbData.height=self.fbData.tabs==='events'?300:500;}else if(self.fbData.small_header){self.fbData.height=self.fbData.show_facepile?165:70;}else if(!self.fbData.small_header){self.fbData.height=self.fbData.show_facepile?225:150;}
options.registry.facebookPage.prototype.markFbElement(self.getParent(),self.$previewPage,self.fbData);},404:function(){self._toggleWarning(false);},},});}else{this._toggleWarning(false);}},_toggleWarning:function(toggle){this.trigger_up('animation_stop_demand',{$target:this.$previewPage,});this.$('.facebook_page_warning').toggleClass('d-none',toggle);this.$footer.find('.btn-primary').prop('disabled',!toggle);},_onOptionChange:function(){var self=this;this.fbData.tabs=_.map(this.$('.o_facebook_tabs input:checked'),function(tab){return tab.name;}).join(',');this.fbData.href=this.$('.o_facebook_page_url').val();_.each(this.$('.o_facebook_options input'),function(el){self.fbData[el.name]=$(el).prop('checked');});this._renderPreview();},});options.registry.facebookPage=options.Class.extend({willStart:function(){var defs=[this._super.apply(this,arguments)];var defaults={href:false,height:215,width:350,tabs:'',small_header:false,hide_cover:false,show_facepile:false,};this.fbData=_.defaults(_.pick(this.$target.data(),_.keys(defaults)),defaults);if(!this.fbData.href){var self=this;defs.push(this._rpc({model:'website',method:'search_read',args:[[],['social_facebook']],limit:1,}).then(function(res){if(res){self.fbData.href=res[0].social_facebook||'https://www.facebook.com/Odoo';}}));}
return $.when.apply($,defs);},start:function(){var self=this;this.$target.on('click.facebook_page_option','.o_add_facebook_page',function(ev){ev.preventDefault();self.fbPageOptions();});return this._super.apply(this,arguments);},destroy:function(){this._super.apply(this,arguments);this.$target.off('.facebook_page_option');},fbPageOptions:function(){var dialog=new FacebookPageDialog(this,this.fbData).open();dialog.on('save',this,function(fbData){this.$target.empty();this.fbData=fbData;options.registry.facebookPage.prototype.markFbElement(this,this.$target,this.fbData);});},markFbElement:function(self,$el,fbData){_.each(fbData,function(value,key){$el.attr('data-'+key,value);$el.data(key,value);});self._refreshAnimations($el);},});options.registry.ul=options.Class.extend({start:function(){var self=this;this.$target.on('mouseup','.o_ul_toggle_self, .o_ul_toggle_next',function(){self.trigger_up('cover_update');});return this._super.apply(this,arguments);},cleanForSave:function(){this._super();if(!this.$target.hasClass('o_ul_folded')){this.$target.find('.o_close').removeClass('o_close');}
this.$target.find('li:not(:has(>ul))').css('list-style','');},toggleClass:function(){this._super.apply(this,arguments);this.trigger_up('animation_stop_demand',{$target:this.$target,});this.$target.find('.o_ul_toggle_self, .o_ul_toggle_next').remove();this.$target.find('li:has(>ul,>ol)').map(function(){var texts=_.filter(_.toArray(this.childNodes),function(a){return a.nodeType===3;});if(!texts.length||!texts.reduce(function(a,b){return a.textContent+b.textContent;}).match(/\S/)){return;}
$(this).children('ul,ol').addClass('o_close');return $(this).children(':not(ul,ol)')[0]||this;}).prepend('<a href="#" class="o_ul_toggle_self fa" />');var $li=this.$target.find('li:has(+li:not(>.o_ul_toggle_self)>ul, +li:not(>.o_ul_toggle_self)>ol)');$li.map(function(){return $(this).children()[0]||this;}).prepend('<a href="#" class="o_ul_toggle_next fa" />');$li.removeClass('o_open').next().addClass('o_close');this.$target.find('li').removeClass('o_open').css('list-style','');this.$target.find('li:has(.o_ul_toggle_self, .o_ul_toggle_next), li:has(>ul,>ol):not(:has(>li))').css('list-style','none');this.$target.find('li:not(:has(>ul))').css('list-style','');this._refreshAnimations();},});options.registry.collapse=options.Class.extend({start:function(){var self=this;this.$target.on('shown.bs.collapse hidden.bs.collapse','[role="tabpanel"]',function(){self.trigger_up('cover_update');});return this._super.apply(this,arguments);},onBuilt:function(){this._createIDs();},onClone:function(){this.$target.find('[data-toggle="collapse"]').removeAttr('data-target').removeData('target');this.$target.find('.collapse').removeAttr('id');this._createIDs();},onMove:function(){this._createIDs();var $panel=this.$target.find('.collapse').removeData('bs.collapse');if($panel.attr('aria-expanded')==='true'){$panel.closest('.accordion').find('.collapse[aria-expanded="true"]').filter(function(){return this!==$panel[0];}).collapse('hide').one('hidden.bs.collapse',function(){$panel.trigger('shown.bs.collapse');});}},_createIDs:function(){var time=new Date().getTime();var $tab=this.$target.find('[data-toggle="collapse"]');var $tablist=this.$target.closest('.accordion');var tablist_id=$tablist.attr('id');if(!tablist_id){tablist_id='myCollapse'+time;$tablist.attr('id',tablist_id);}
$tab.attr('data-parent','#'+tablist_id);$tab.data('parent','#'+tablist_id);var $panel=this.$target.find('.collapse');var panel_id=$panel.attr('id');if(!panel_id){while($('#'+(panel_id='myCollapseTab'+time)).length){time++;}
$panel.attr('id',panel_id);}
$tab.attr('data-target','#'+panel_id);$tab.data('target','#'+panel_id);},});options.registry.gallery=options.Class.extend({xmlDependencies:['/website/static/src/xml/website.gallery.xml'],start:function(){var self=this;this.$target.attr('contentEditable',false);this.$target.on('save','img',function(ev){var $img=$(ev.currentTarget);var index=self.$target.find('.carousel-item.active').index();self.$('.carousel:first li[data-target]:eq('+index+')').css('background-image','url('+$img.attr('src')+')');});this.$target.on('click','.o_add_images',function(e){e.stopImmediatePropagation();self.addImages(false);});return this._super.apply(this,arguments);},onBuilt:function(){var uuid=new Date().getTime();this.$target.find('.carousel').attr('id','slideshow_'+uuid);this.$target.find('[data-target]').attr('data-target','#slideshow_'+uuid);},cleanForSave:function(){if(this.$target.hasClass('slideshow')){this.$target.removeAttr('style');}},addImages:function(previewMode){var self=this;var $container=this.$('.container:first');var dialog=new weWidgets.MediaDialog(this,{multiImages:true},this.$target.closest('.o_editable'),null);var lastImage=_.last(this._getImages());var index=lastImage?this._getIndex(lastImage):-1;dialog.on('save',this,function(attachments){for(var i=0;i<attachments.length;i++){$('<img/>',{class:'img img-fluid',src:attachments[i].src,'data-index':++index,}).appendTo($container);}
self._reset();self.trigger_up('cover_update');});dialog.open();},columns:function(previewMode,value){this.$target.attr('data-columns',value);var $activeMode=this.$el.find('.active[data-mode]');this.mode(null,$activeMode.data('mode'),$activeMode);},grid:function(){var imgs=this._getImages();var $row=$('<div/>',{class:'row'});var columns=this._getColumns();var colClass='col-lg-'+(12/columns);var $container=this._replaceContent($row);_.each(imgs,function(img,index){var $img=$(img);var $col=$('<div/>',{class:colClass});$col.append($img).appendTo($row);if((index+1)%columns===0){$row=$('<div/>',{class:'row'});$row.appendTo($container);}});this.$target.css('height','');},interval:function(previewMode,value){this.$target.find('.carousel:first').attr('data-interval',value);},masonry:function(){var self=this;var imgs=this._getImages();var columns=this._getColumns();var colClass='col-lg-'+(12/columns);var cols=[];var $row=$('<div/>',{class:'row'});this._replaceContent($row);for(var c=0;c<columns;c++){var $col=$('<div/>',{class:'col o_snippet_not_selectable '+colClass});$row.append($col);cols.push($col[0]);}
while(imgs.length){var min=Infinity;var $lowest;_.each(cols,function(col){var $col=$(col);var height=$col.is(':empty')?0:$col.find('img').last().offset().top+$col.find('img').last().height()-self.$target.offset().top;if(height<min){min=height;$lowest=$col;}});$lowest.append(imgs.pop());}},mode:function(previewMode,value,$opt){this.$target.css('height','');this[value]();this.$target.removeClass('o_nomode o_masonry o_grid o_slideshow').addClass('o_'+value);},nomode:function(){var $row=$('<div/>',{class:'row'});var imgs=this._getImages();this._replaceContent($row);_.each(imgs,function(img){var wrapClass='col-lg-3';if(img.width>=img.height*2||img.width>600){wrapClass='col-lg-6';}
var $wrap=$('<div/>',{class:wrapClass}).append(img);$row.append($wrap);});},removeAllImages:function(previewMode){var $addImg=$('<div>',{class:'alert alert-info css_editable_mode_display text-center',});var $text=$('<span>',{class:'o_add_images',style:'cursor: pointer;',text:_t(" Add Images"),});var $icon=$('<i>',{class:' fa fa-plus-circle',});this._replaceContent($addImg.append($icon).append($text));},slideshow:function(){var imgStyle=this.$el.find('.active[data-styling]').data('styling')||'';var urls=_.map(this._getImages(),function(img){return $(img).attr('src');});var params={srcs:urls,index:0,title:"",interval:this.$target.data('interval')||false,id:'slideshow_'+new Date().getTime(),userStyle:imgStyle,},$slideshow=$(qweb.render('website.gallery.slideshow',params));this._replaceContent($slideshow);_.each(this.$('img'),function(img,index){$(img).attr({contenteditable:true,'data-index':index});});this.$target.css('height',Math.round(window.innerHeight*0.7));this.$target.off('slide.bs.carousel').off('slid.bs.carousel');this.$('li.fa').off('click');this._refreshAnimations();},styling:function(previewMode,value){var classes=_.map(this.$el.find('[data-styling]'),function(el){return $(el).data('styling');}).join(' ');this.$('img').removeClass(classes).addClass(value);},notify:function(name,data){this._super.apply(this,arguments);if(name==='image_removed'){data.$image.remove();this._reset();}else if(name==='image_index_request'){var imgs=this._getImages();var position=_.indexOf(imgs,data.$image[0]);imgs.splice(position,1);switch(data.position){case'first':imgs.unshift(data.$image[0]);break;case'prev':imgs.splice(position-1,0,data.$image[0]);break;case'next':imgs.splice(position+1,0,data.$image[0]);break;case'last':imgs.push(data.$image[0]);break;}
_.each(imgs,function(img,index){$(img).attr('data-index',index);});this._reset();}},_getImages:function(){var imgs=this.$('img').get();var self=this;imgs.sort(function(a,b){return self._getIndex(a)-self._getIndex(b);});return imgs;},_getIndex:function(img){return img.dataset.index||0;},_getColumns:function(){return parseInt(this.$target.attr('data-columns'))||3;},_replaceContent:function($content){var $container=this.$('.container:first');$container.empty().append($content);return $container;},_setActive:function(){this._super();var classes=_.uniq((this.$target.attr('class').replace(/(^|\s)o_/g,' ')||'').split(/\s+/));this.$el.find('[data-mode]').removeClass('active').filter('[data-mode="'+classes.join('"], [data-mode="')+'"]').addClass('active');var mode=this.$el.find('[data-mode].active').data('mode');classes=_.uniq((this.$('img:first').attr('class')||'').split(/\s+/));this.$el.find('[data-styling]').removeClass('active').filter('[data-styling="'+classes.join('"], [data-styling="')+'"]').addClass('active');this.$el.find('[data-interval]').removeClass('active').filter('[data-interval='+this.$target.find('.carousel:first').attr('data-interval')+']').addClass('active');var interval=this.$target.find('.carousel:first').attr('data-interval');this.$el.find('[data-interval]').removeClass('active').filter('[data-interval='+interval+']').addClass('active');var columns=this._getColumns();this.$el.find('[data-columns]').removeClass('active').filter('[data-columns='+columns+']').addClass('active');this.$el.find('[data-columns]:first, [data-select-class="spc-none"]').parent().parent().toggle(['grid','masonry'].indexOf(mode)!==-1);this.$el.find('[data-interval]:first').parent().parent().toggle(mode==='slideshow');},});options.registry.gallery_img=options.Class.extend({onRemove:function(){this.trigger_up('option_update',{optionName:'gallery',name:'image_removed',data:{$image:this.$target,},});},position:function(previewMode,value){this.trigger_up('deactivate_snippet');this.trigger_up('option_update',{optionName:'gallery',name:'image_index_request',data:{$image:this.$target,position:value,},});},});options.registry.topMenuTransparency=options.Class.extend({transparent:function(previewMode,value,$opt){var self=this;this.trigger_up('action_demand',{actionName:'toggle_page_option',params:[{name:'header_overlay'}],onSuccess:function(){self.trigger_up('action_demand',{actionName:'toggle_page_option',params:[{name:'header_color',value:''}],});},});},_setActive:function(){this._super.apply(this,arguments);var enabled;this.trigger_up('action_demand',{actionName:'get_page_option',params:['header_overlay'],onSuccess:function(value){enabled=value;},});this.$el.find('[data-transparent]').addBack('[data-transparent]').toggleClass('active',!!enabled);},});options.registry.topMenuColor=options.registry.colorpicker.extend({start:function(){var self=this;var def=this._super.apply(this,arguments);this.$target.on('snippet-option-change',function(){self.onFocus();});return def;},onFocus:function(){var enabled;this.trigger_up('action_demand',{actionName:'get_page_option',params:['header_overlay'],onSuccess:function(value){enabled=value;},});this.$el.toggleClass('d-none',!enabled);},_onColorButtonClick:function(){this._super.apply(this,arguments);var bgs=this.$target.attr('class').match(/bg-(\w|-)+/g);var allowedBgs=this.classes.split(' ');var color=_.intersection(bgs,allowedBgs).join(' ');this.trigger_up('action_demand',{actionName:'toggle_page_option',params:[{name:'header_color',value:color}],});},});});;

/* /website/static/src/js/menu/content.js defined in bundle 'website.assets_editor' */
odoo.define('website.contentMenu',function(require){'use strict';var Class=require('web.Class');var core=require('web.core');var Dialog=require('web.Dialog');var time=require('web.time');var weContext=require('web_editor.context');var weWidgets=require('web_editor.widget');var websiteNavbarData=require('website.navbar');var websiteRootData=require('website.WebsiteRoot');var Widget=require('web.Widget');var _t=core._t;var qweb=core.qweb;var PagePropertiesDialog=weWidgets.Dialog.extend({template:'website.pagesMenu.page_info',xmlDependencies:weWidgets.Dialog.prototype.xmlDependencies.concat(['/website/static/src/xml/website.pageProperties.xml']),events:_.extend({},weWidgets.Dialog.prototype.events,{'keyup input#page_name':'_onNameChanged','keyup input#page_url':'_onUrlChanged','change input#create_redirect':'_onCreateRedirectChanged',}),init:function(parent,page_id,options){var self=this;var serverUrl=window.location.origin+'/';var length_url=serverUrl.length;var serverUrlTrunc=serverUrl;if(length_url>30){serverUrlTrunc=serverUrl.slice(0,14)+'..'+serverUrl.slice(-14);}
this.serverUrl=serverUrl;this.serverUrlTrunc=serverUrlTrunc;this.current_page_url=window.location.pathname;this.page_id=page_id;var buttons=[{text:_t("Save"),classes:'btn-primary',click:this.save},{text:_t("Discard"),close:true},];if(options.fromPageManagement){buttons.push({text:_t("Go To Page"),icon:'fa-globe',classes:'btn-link float-right',click:function(e){window.location.href='/'+self.page.url;},});}
buttons.push({text:_t("Delete Page"),icon:'fa-trash',classes:'btn-link float-right',click:function(e){_deletePage.call(this,self.page_id,options.fromPageManagement);},});this._super(parent,_.extend({},{title:_t("Page Properties"),size:'medium',buttons:buttons,},options||{}));},willStart:function(){var defs=[this._super.apply(this,arguments)];var self=this;defs.push(this._rpc({model:'website.page',method:'get_page_info',args:[this.page_id],}).then(function(page){page[0].url=_.str.startsWith(page[0].url,'/')?page[0].url.substring(1):page[0].url;self.page=page[0];}));defs.push(this._rpc({model:'website.redirect',method:'fields_get',}).then(function(fields){self.fields=fields;}));return $.when.apply($,defs);},start:function(){var self=this;var defs=[this._super.apply(this,arguments)];this.$('.ask_for_redirect').addClass('d-none');this.$('.redirect_type').addClass('d-none');this.$('.warn_about_call').addClass('d-none');defs.push(this._getPageDependencies(this.page_id).then(function(dependencies){var dep_text=[];_.each(dependencies,function(value,index){if(value.length>0){dep_text.push(value.length+' '+index.toLowerCase());}});dep_text=dep_text.join(', ');self.$('#dependencies_redirect').html(qweb.render('website.show_page_dependencies',{dependencies:dependencies,dep_text:dep_text}));self.$('#dependencies_redirect [data-toggle="popover"]').popover({container:'body',});}));defs.push(this._getSupportedMimetype().then(function(mimetypes){self.supportedMimetype=mimetypes;}));defs.push(this._getPageKeyDependencies(this.page_id).then(function(dependencies){var dep_text=[];_.each(dependencies,function(value,index){if(value.length>0){dep_text.push(value.length+' '+index.toLowerCase());}});dep_text=dep_text.join(', ');self.$('.warn_about_call').html(qweb.render('website.show_page_key_dependencies',{dependencies:dependencies,dep_text:dep_text}));self.$('.warn_about_call [data-toggle="popover"]').popover({container:'body',});}));defs.push(this._rpc({model:'res.users',method:'has_group',args:['website.group_multi_website']}).then(function(has_group){if(!has_group){self.$('#website_restriction').addClass('hidden');}}));var datepickersOptions={minDate:moment({y:1900}),maxDate:moment().add(200,'y'),calendarWeeks:true,icons:{time:'fa fa-clock-o',date:'fa fa-calendar',next:'fa fa-chevron-right',previous:'fa fa-chevron-left',up:'fa fa-chevron-up',down:'fa fa-chevron-down',},locale:moment.locale(),format:time.getLangDatetimeFormat(),widgetPositioning:{horizontal:'auto',vertical:'top',},widgetParent:'body',};if(this.page.date_publish){datepickersOptions.defaultDate=time.str_to_datetime(this.page.date_publish);}
this.$('#date_publish_container').datetimepicker(datepickersOptions);return $.when.apply($,defs);},destroy:function(){$('.popover').popover('hide');return this._super.apply(this,arguments);},save:function(data){var self=this;var context=weContext.get();var url=this.$('#page_url').val();var $date_publish=this.$("#date_publish");$date_publish.closest(".form-group").removeClass('o_has_error').find('.form-control, .custom-select').removeClass('is-invalid');var date_publish=$date_publish.val();if(date_publish!==""){date_publish=this._parse_date(date_publish);if(!date_publish){$date_publish.closest(".form-group").addClass('o_has_error').find('.form-control, .custom-select').addClass('is-invalid');return;}}
var params={id:this.page.id,name:this.$('#page_name').val(),url:url.replace(/\/{2,}/g,'/'),is_menu:this.$('#is_menu').prop('checked'),is_homepage:this.$('#is_homepage').prop('checked'),website_published:this.$('#is_published').prop('checked'),create_redirect:this.$('#create_redirect').prop('checked'),redirect_type:this.$('#redirect_type').val(),website_indexed:this.$('#is_indexed').prop('checked'),date_publish:date_publish,};this._rpc({model:'website.page',method:'save_page_info',args:[[context.website_id],params],}).then(function(url){var mo;self.trigger_up('main_object_request',{callback:function(value){mo=value;},});if(mo.model==='website.page'){window.location.href=url.toLowerCase();}else{window.location.reload(true);}});},_getPageDependencies:function(moID){return this._rpc({model:'website',method:'page_search_dependencies',args:[moID],});},_getPageKeyDependencies:function(moID){return this._rpc({model:'website',method:'page_search_key_dependencies',args:[moID],});},_getSupportedMimetype:function(){return this._rpc({model:'website',method:'guess_mimetype',});},_getMainObject:function(){var repr=$('html').data('main-object');var m=repr.match(/(.+)\((\d+),(.*)\)/);return{model:m[1],id:m[2]|0,};},_parse_date:function(value){var datetime=moment(value,time.getLangDatetimeFormat(),true);if(datetime.isValid()){return time.datetime_to_str(datetime.toDate());}
else{return false;}},_onUrlChanged:function(){var url=this.$('input#page_url').val();this.$('.ask_for_redirect').toggleClass('d-none',url===this.page.url);},_onNameChanged:function(){var name=this.$('input#page_name').val();var ext='.'+this.page.name.split('.').pop();if(ext in this.supportedMimetype&&ext!=='.html'){this.$('.warn_about_call').toggleClass('d-none',name===this.page.name);}},_onCreateRedirectChanged:function(){var createRedirect=this.$('input#create_redirect').prop('checked');this.$('.redirect_type').toggleClass('d-none',!createRedirect);},});var MenuEntryDialog=weWidgets.LinkDialog.extend({xmlDependencies:weWidgets.LinkDialog.prototype.xmlDependencies.concat(['/website/static/src/xml/website.contentMenu.xml']),init:function(parent,options,editor,data){data.text=data.name||'';data.isNewWindow=data.new_window;this.data=data;this._super(parent,_.extend({},{title:_t("Create Menu"),},options||{}),editor,data);},start:function(){this.$('.o_link_dialog_preview').remove();this.$('input[name="is_new_window"], .link-style').closest('.form-group').remove();this.$modal.find('.modal-lg').removeClass('modal-lg');this.$('form.col-lg-8').removeClass('col-lg-8').addClass('col-12');this.$('label[for="o_link_dialog_label_input"]').text(_t("Menu Label"));this.$('#o_link_dialog_url_input').after(qweb.render('website.contentMenu.dialog.edit.link_menu_hint'));return this._super.apply(this,arguments);},save:function(){var $e=this.$('#o_link_dialog_label_input');if(!$e.val()||!$e[0].checkValidity()){$e.closest('.form-group').addClass('o_has_error').find('.form-control, .custom-select').addClass('is-invalid')
$e.focus();return;}
return this._super.apply(this,arguments);},});var SelectEditMenuDialog=weWidgets.Dialog.extend({template:'website.contentMenu.dialog.select',xmlDependencies:weWidgets.Dialog.prototype.xmlDependencies.concat(['/website/static/src/xml/website.contentMenu.xml']),init:function(parent,options){var self=this;self.roots=[{id:null,name:_t("Top Menu")}];$('[data-content_menu_id]').each(function(){self.roots.push({id:$(this).data('content_menu_id'),name:$(this).attr('name')});});this._super(parent,_.extend({},{title:_t("Select a Menu"),save_text:_t("Continue")},options||{}));},save:function(){this.final_data=parseInt(this.$el.find('select').val()||null);this._super.apply(this,arguments);},});var EditMenuDialog=weWidgets.Dialog.extend({template:'website.contentMenu.dialog.edit',xmlDependencies:weWidgets.Dialog.prototype.xmlDependencies.concat(['/website/static/src/xml/website.contentMenu.xml']),events:_.extend({},weWidgets.Dialog.prototype.events,{'click a.js_add_menu':'_onAddMenuButtonClick','click button.js_delete_menu':'_onDeleteMenuButtonClick','click button.js_edit_menu':'_onEditMenuButtonClick',}),init:function(parent,options,rootID){this._super(parent,_.extend({},{title:_t("Edit Menu"),size:'medium',},options||{}));this.rootID=rootID;},willStart:function(){var defs=[this._super.apply(this,arguments)];var self=this;var context=weContext.get();defs.push(this._rpc({model:'website.menu',method:'get_tree',args:[context.website_id,this.rootID],}).then(function(menu){self.menu=menu;self.root_menu_id=menu.id;self.flat=self._flatenize(menu);self.to_delete=[];}));return $.when.apply($,defs);},start:function(){var r=this._super.apply(this,arguments);this.$('.oe_menu_editor').nestedSortable({listType:'ul',handle:'div',items:'li',maxLevels:2,toleranceElement:'> div',forcePlaceholderSize:true,opacity:0.6,placeholder:'oe_menu_placeholder',tolerance:'pointer',attribute:'data-menu-id',expression:'()(.+)',});return r;},save:function(){var _super=this._super.bind(this);var self=this;var new_menu=this.$('.oe_menu_editor').nestedSortable('toArray',{startDepthCount:0});var levels=[];var data=[];var context=weContext.get();new_menu.forEach(function(menu){if(menu.id){levels[menu.depth]=(levels[menu.depth]||0)+1;var mobj=self.flat[menu.id];mobj.sequence=levels[menu.depth];mobj.parent_id=(menu.parent_id|0)||menu.parent_id||self.root_menu_id;delete(mobj.children);data.push(mobj);}});this._rpc({model:'website.menu',method:'save',args:[context.website_id,{data:data,to_delete:self.to_delete}],}).then(function(){return _super();});},_flatenize:function(node,_dict){_dict=_dict||{};var self=this;_dict[node.id]=node;node.children.forEach(function(child){self._flatenize(child,_dict);});return _dict;},_onAddMenuButtonClick:function(){var self=this;var dialog=new MenuEntryDialog(this,{},undefined,{});dialog.on('save',this,function(link){var new_menu={id:_.uniqueId('new-'),name:link.text,url:link.url,new_window:link.isNewWindow,parent_id:false,sequence:0,children:[],};self.flat[new_menu.id]=new_menu;self.$('.oe_menu_editor').append(qweb.render('website.contentMenu.dialog.submenu',{submenu:new_menu}));});dialog.open();},_onDeleteMenuButtonClick:function(ev){var $menu=$(ev.currentTarget).closest('[data-menu-id]');var menuID=$menu.data('menu-id')|0;if(menuID){this.to_delete.push(menuID);}
$menu.remove();},_onEditMenuButtonClick:function(ev){var self=this;var menu_id=$(ev.currentTarget).closest('[data-menu-id]').data('menu-id');var menu=self.flat[menu_id];if(menu){var dialog=new MenuEntryDialog(this,{},undefined,menu);dialog.on('save',this,function(link){var id=link.id;var menu_obj=self.flat[id];_.extend(menu_obj,{'name':link.text,'url':link.url,'new_window':link.isNewWindow,});var $menu=self.$('[data-menu-id="'+id+'"]');$menu.find('.js_menu_label').first().text(menu_obj.name);});dialog.open();}else{Dialog.alert(null,"Could not find menu entry");}},});var PageOption=Class.extend({init:function(name,value,setValueCallback){this.name=name;this.value=value;this.isDirty=false;this.setValueCallback=setValueCallback;},setValue:function(value){if(value===undefined){value=!this.value;}
this.setValueCallback.call(this,value);this.value=value;this.isDirty=true;},});var ContentMenu=websiteNavbarData.WebsiteNavbarActionWidget.extend({xmlDependencies:['/website/static/src/xml/website.xml'],actions:_.extend({},websiteNavbarData.WebsiteNavbarActionWidget.prototype.actions||{},{edit_menu:'_editMenu',get_page_option:'_getPageOption',on_save:'_onSave',page_properties:'_pageProperties',toggle_page_option:'_togglePageOption',}),pageOptionsSetValueCallbacks:{header_overlay:function(value){$('#wrapwrap').toggleClass('o_header_overlay',value);},header_color:function(value){$('#wrapwrap > header').removeClass(this.value).addClass(value);},},start:function(){var self=this;this.pageOptions={};_.each($('.o_page_option_data'),function(el){var value=el.value;if(value==="True"){value=true;}else if(value==="False"){value=false;}
self.pageOptions[el.name]=new PageOption(el.name,value,self.pageOptionsSetValueCallbacks[el.name]);});return this._super.apply(this,arguments);},_editMenu:function(beforeReloadCallback){var self=this;var def=$.Deferred();var selectDef=$.Deferred();if($('[data-content_menu_id]').length){var select=new SelectEditMenuDialog(this);select.on('save',selectDef,selectDef.resolve);select.on('cancel',def,def.resolve);select.open();}else{selectDef.resolve(null);}
selectDef.then(function(rootID){var editDef=$.Deferred();var dialog=new EditMenuDialog(self,{},rootID).open();dialog.on('save',editDef,editDef.resolve);dialog.on('cancel',def,def.resolve);return editDef;}).then(function(){return beforeReloadCallback&&beforeReloadCallback();}).then(function(){window.location.reload(true);});return def;},_getPageOption:function(name){var option=this.pageOptions[name];if(!option){return $.Deferred().reject();}
return $.when(option.value);},_onSave:function(){var self=this;var defs=_.map(this.pageOptions,function(option,optionName){if(option.isDirty){return self._togglePageOption({name:optionName,value:option.value,},true,true);}});return $.when.apply($,defs);},_pageProperties:function(){var mo;this.trigger_up('main_object_request',{callback:function(value){mo=value;},});var dialog=new PagePropertiesDialog(this,mo.id,{}).open();return dialog.opened();},_togglePageOption:function(params,forceSave,noReload){var mo;this.trigger_up('main_object_request',{callback:function(value){mo=value;},});if(mo.model!=='website.page'){return $.Deferred().reject();}
var option=this.pageOptions[params.name];if(!option){return $.Deferred().reject();}
option.setValue(params.value);if(!forceSave){return $.when();}
var vals={};vals[params.name]=option.value;var def=this._rpc({model:'website.page',method:'write',args:[[mo.id],vals],});if(noReload){return def;}
return def.then(function(){window.location.reload();return $.Deferred();});},});var PageManagement=Widget.extend({xmlDependencies:['/website/static/src/xml/website.xml'],events:{'click a.js_page_properties':'_onPagePropertiesButtonClick','click a.js_clone_page':'_onClonePageButtonClick','click a.js_delete_page':'_onDeletePageButtonClick',},_getPageDependencies:function(moID){return this._rpc({model:'website',method:'page_search_dependencies',args:[moID],});},_onPagePropertiesButtonClick:function(ev){var moID=$(ev.currentTarget).data('id');var dialog=new PagePropertiesDialog(this,moID,{'fromPageManagement':true}).open();return dialog;},_onClonePageButtonClick:function(ev){var pageId=$(ev.currentTarget).data('id');this._rpc({model:'website.page',method:'clone_page',args:[pageId],}).then(function(path){window.location.href=path;});},_onDeletePageButtonClick:function(ev){var pageId=$(ev.currentTarget).data('id');_deletePage.call(this,pageId,true);},});function _deletePage(pageId,fromPageManagement){var self=this;var def=$.Deferred();this._getPageDependencies(pageId).then(function(dependencies){var confirmDef=$.Deferred();Dialog.safeConfirm(self,"",{title:_t("Delete Page"),$content:$(qweb.render('website.delete_page',{dependencies:dependencies})),confirm_callback:confirmDef.resolve.bind(confirmDef),cancel_callback:def.resolve.bind(self),});return confirmDef;}).then(function(){return self._rpc({model:'website.page',method:'unlink',args:[pageId],});}).then(function(){if(fromPageManagement){window.location.reload(true);}
else{window.location.href='/';}},def.reject.bind(def));}
websiteNavbarData.websiteNavbarRegistry.add(ContentMenu,'#content-menu');websiteRootData.websiteRootRegistry.add(PageManagement,'#list_website_pages');return{PagePropertiesDialog:PagePropertiesDialog,ContentMenu:ContentMenu,EditMenuDialog:EditMenuDialog,MenuEntryDialog:MenuEntryDialog,SelectEditMenuDialog:SelectEditMenuDialog,};});;

/* /website/static/src/js/menu/customize.js defined in bundle 'website.assets_editor' */
odoo.define('website.customizeMenu',function(require){'use strict';var core=require('web.core');var Widget=require('web.Widget');var websiteNavbarData=require('website.navbar');var WebsiteAceEditor=require('website.ace');var qweb=core.qweb;var CustomizeMenu=Widget.extend({xmlDependencies:['/web_editor/static/src/xml/editor.xml'],events:{'show.bs.dropdown':'_onDropdownShow','click .dropdown-item[data-view-id]':'_onCustomizeOptionClick',},willStart:function(){this.viewName=$(document.documentElement).data('view-xmlid');return this._super.apply(this,arguments);},start:function(){if(!this.viewName){_.defer(this.destroy.bind(this));}
if(this.$el.is('.show')){this._loadCustomizeOptions();}
return this._super.apply(this,arguments);},_doCustomize:function(viewID){return this._rpc({model:'ir.ui.view',method:'toggle',args:[[viewID]],}).then(function(){window.location.reload();return $.Deferred();});},_loadCustomizeOptions:function(){if(this.__customizeOptionsLoaded){return $.when();}
this.__customizeOptionsLoaded=true;var $menu=this.$el.children('.dropdown-menu');return this._rpc({route:'/website/get_switchable_related_views',params:{key:this.viewName,},}).then(function(result){var currentGroup='';_.each(result,function(item){if(currentGroup!==item.inherit_id[1]){currentGroup=item.inherit_id[1];$menu.append('<li class="dropdown-header">'+currentGroup+'</li>');}
var $a=$('<a/>',{href:'#',class:'dropdown-item','data-view-id':item.id,role:'menuitem'}).append(qweb.render('web_editor.components.switch',{id:'switch-'+item.id,label:item.name}));$a.find('input').prop('checked',!!item.active);$menu.append($a);});});},_onCustomizeOptionClick:function(ev){ev.preventDefault();var viewID=parseInt($(ev.currentTarget).data('view-id'),10);this._doCustomize(viewID);},_onDropdownShow:function(){this._loadCustomizeOptions();},});var AceEditorMenu=websiteNavbarData.WebsiteNavbarActionWidget.extend({actions:_.extend({},websiteNavbarData.WebsiteNavbarActionWidget.prototype.actions||{},{close_all_widgets:'_hideEditor',edit:'_enterEditMode',ace:'_launchAce',}),start:function(){if(window.location.hash.substr(0,WebsiteAceEditor.prototype.hash.length)===WebsiteAceEditor.prototype.hash){this._launchAce();}
return this._super.apply(this,arguments);},_enterEditMode:function(){this._hideEditor();},_hideEditor:function(){if(this.globalEditor){this.globalEditor.do_hide();}},_launchAce:function(){var def=$.Deferred();this.trigger_up('action_demand',{actionName:'close_all_widgets',onSuccess:def.resolve.bind(def),});return def.then((function(){if(this.globalEditor){this.globalEditor.do_show();return $.when();}else{var currentHash=window.location.hash;var indexOfView=currentHash.indexOf("?res=");var initialResID=undefined;if(indexOfView>=0){initialResID=currentHash.substr(indexOfView+("?res=".length));var parsedResID=parseInt(initialResID,10);if(parsedResID){initialResID=parsedResID;}}
this.globalEditor=new WebsiteAceEditor(this,$(document.documentElement).data('view-xmlid'),{initialResID:initialResID,defaultBundlesRestriction:["web.assets_frontend","website.assets_frontend",],});return this.globalEditor.appendTo(document.body);}}).bind(this));},});websiteNavbarData.websiteNavbarRegistry.add(CustomizeMenu,'#customize-menu');websiteNavbarData.websiteNavbarRegistry.add(AceEditorMenu,'#html_editor');return CustomizeMenu;});;

/* /website/static/src/js/menu/edit.js defined in bundle 'website.assets_editor' */
odoo.define('website.editMenu',function(require){'use strict';var core=require('web.core');var weContext=require('web_editor.context');var editor=require('web_editor.editor');var websiteNavbarData=require('website.navbar');var _t=core._t;var EditPageMenu=websiteNavbarData.WebsiteNavbarActionWidget.extend({xmlDependencies:['/website/static/src/xml/website.editor.xml'],actions:_.extend({},websiteNavbarData.WebsiteNavbarActionWidget.prototype.actions,{edit:'_startEditMode',on_save:'_onSave',}),custom_events:_.extend({},websiteNavbarData.WebsiteNavbarActionWidget.custom_events||{},{content_will_be_destroyed:'_onContentWillBeDestroyed',content_was_recreated:'_onContentWasRecreated',snippet_cloned:'_onSnippetCloned',snippet_dropped:'_onSnippetDropped',}),init:function(){this._super.apply(this,arguments);this._editorAutoStart=(weContext.getExtra().editable&&window.location.search.indexOf('enable_editor')>=0);},start:function(){var def=this._super.apply(this,arguments);if(this._editorAutoStart){this._startEditMode();return def;}
var $wrap=$('#wrapwrap.homepage #wrap');if(!$wrap.length||$wrap.html().trim()!==''){return def;}
this.$welcomeMessage=$(core.qweb.render('website.homepage_editor_welcome_message'));this.$welcomeMessage.css('min-height',$wrap.parent('main').height()-($wrap.outerHeight(true)-$wrap.height()));$wrap.empty().append(this.$welcomeMessage);setTimeout(function(){if($('.o_tooltip.o_animated').length){$('.o_tooltip_container').addClass('show');}},1000);return def;},_startEditMode:function(){var self=this;return(new(editor.Class)(this)).prependTo(document.body).then(function(){if(self.$welcomeMessage){self.$welcomeMessage.remove();}
var $wrapwrap=$('#wrapwrap');self.$editorMessageElements=$wrapwrap.find('.oe_structure.oe_empty, [data-oe-type="html"]').attr('data-editor-message',_t('DRAG BUILDING BLOCKS HERE'));var def=$.Deferred();self.trigger_up('animation_start_demand',{editableMode:true,onSuccess:def.resolve.bind(def),onFailure:def.reject.bind(def),});return def;});},_onSave:function(){if(this.$editorMessageElements){this.$editorMessageElements.removeAttr('data-editor-message');}},_onContentWillBeDestroyed:function(ev){this.trigger_up('animation_stop_demand',{$target:ev.data.$target,});},_onContentWasRecreated:function(ev){this.trigger_up('animation_start_demand',{editableMode:true,$target:ev.data.$target,});},_onSnippetCloned:function(ev){this.trigger_up('animation_start_demand',{editableMode:true,$target:ev.data.$target,});},_onSnippetDropped:function(ev){this.trigger_up('animation_start_demand',{editableMode:true,$target:ev.data.$target,});},});websiteNavbarData.websiteNavbarRegistry.add(EditPageMenu,'#edit-page-menu');});;

/* /website/static/src/js/menu/mobile_view.js defined in bundle 'website.assets_editor' */
odoo.define('website.mobile',function(require){'use strict';var core=require('web.core');var Dialog=require('web.Dialog');var websiteNavbarData=require('website.navbar');var _t=core._t;var MobilePreviewDialog=Dialog.extend({start:function(){var self=this;this.$modal.addClass('oe_mobile_preview');this.$modal.on('click','.modal-header',function(){self.$el.toggleClass('o_invert_orientation');});this.$iframe=$('<iframe/>',{id:'mobile-viewport',src:$.param.querystring(window.location.href,'mobilepreview'),});this.$iframe.on('load',function(e){self.$iframe.contents().find('body').removeClass('o_connected_user');self.$iframe.contents().find('#oe_main_menu_navbar').remove();});this.$iframe.appendTo(this.$el);return this._super.apply(this,arguments);},});var MobileMenu=websiteNavbarData.WebsiteNavbarActionWidget.extend({actions:_.extend({},websiteNavbarData.WebsiteNavbarActionWidget.prototype.actions||{},{'show-mobile-preview':'_onMobilePreviewClick',}),_onMobilePreviewClick:function(){new MobilePreviewDialog(this,{title:_t('Mobile preview')+' <span class="fa fa-refresh"/>',}).open();},});websiteNavbarData.websiteNavbarRegistry.add(MobileMenu,'#mobile-menu');return{MobileMenu:MobileMenu,MobilePreviewDialog:MobilePreviewDialog,};});;

/* /website/static/src/js/menu/new_content.js defined in bundle 'website.assets_editor' */
odoo.define('website.newMenu',function(require){'use strict';var core=require('web.core');var Dialog=require('web.Dialog');var websiteNavbarData=require('website.navbar');var wUtils=require('website.utils');var qweb=core.qweb;var _t=core._t;var enableFlag='enable_new_content';var NewContentMenu=websiteNavbarData.WebsiteNavbarActionWidget.extend({xmlDependencies:['/web_editor/static/src/xml/editor.xml'],actions:_.extend({},websiteNavbarData.WebsiteNavbarActionWidget.prototype.actions||{},{close_all_widgets:'_handleCloseDemand',new_page:'_createNewPage',}),events:_.extend({},websiteNavbarData.WebsiteNavbarActionWidget.prototype.events||{},{'click':'_onBackgroundClick','click [data-module-id]':'_onModuleIdClick','keydown':'_onBackgroundKeydown',}),newContentText:{failed:_t('Failed to install "%s"'),installInProgress:_t("The installation of an App is already in progress."),installNeeded:_t('Do you want to install the "%s" App?'),installPleaseWait:_t('Installing "%s"'),},start:function(){this.pendingInstall=false;this.$newContentMenuChoices=this.$('#o_new_content_menu_choices');var $modules=this.$newContentMenuChoices.find('.o_new_content_element');_.each($modules,function(el,index){var $el=$(el);$el.data('original-index',index);if($el.data('module-id')){$el.appendTo($el.parent());$el.find('a i, a p').addClass('text-muted');}});this.$firstLink=this.$newContentMenuChoices.find('a:eq(0)');this.$lastLink=this.$newContentMenuChoices.find('a:last');if($.deparam.querystring()[enableFlag]!==undefined){this._showMenu();}
return this._super.apply(this,arguments);},_createNewPage:function(){return wUtils.prompt({id:'editor_new_page',window_title:_t("New Page"),input:_t("Page Title"),init:function(){var $group=this.$dialog.find('div.form-group');$group.removeClass('mb0');var $add=$('<div/>',{'class':'form-group mb0 row'}).append($('<span/>',{'class':'offset-md-3 col-md-9 text-left'}).append(qweb.render('web_editor.components.switch',{id:'switch_addTo_menu',label:_t("Add to menu")})));$add.find('input').prop('checked',true);$group.after($add);}}).then(function(val,field,$dialog){if(!val){return;}
var url='/website/add/'+encodeURIComponent(val);if($dialog.find('input[type="checkbox"]').is(':checked'))url+='?add_menu=1';document.location=url;return $.Deferred();});},_handleCloseDemand:function(){this._hideMenu();},_focusFirstLink:function(){this.$firstLink.focus();},_focusLastLink:function(){this.$lastLink.focus();},_hideMenu:function(){this.$newContentMenuChoices.addClass('o_hidden');$('body').removeClass('o_new_content_open');},_install:function(moduleId){this.pendingInstall=true;$('body').css('pointer-events','none');return this._rpc({model:'ir.module.module',method:'button_immediate_install',args:[[moduleId]],}).fail(function(){$('body').css('pointer-events','');});},_showMenu:function(){var def=$.Deferred();this.trigger_up('action_demand',{actionName:'close_all_widgets',onSuccess:def.resolve.bind(def),});return def.then((function(){this.firstTab=true;this.$newContentMenuChoices.removeClass('o_hidden');$('body').addClass('o_new_content_open');this.$('> a').focus();}).bind(this));},_onBackgroundClick:function(ev){if(this.$newContentMenuChoices.hasClass('o_hidden')){this._showMenu();}else{this._hideMenu();}},_onBackgroundKeydown:function(ev){switch(ev.which){case $.ui.keyCode.ESCAPE:this._hideMenu();break;case $.ui.keyCode.TAB:if(ev.shiftKey){if(this.firstTab||document.activeElement===this.$firstLink[0]){this._focusLastLink();ev.preventDefault();}}else{if(this.firstTab||document.activeElement===this.$lastLink[0]){this._focusFirstLink();ev.preventDefault();}}
this.firstTab=false;break;}},_onModuleIdClick:function(ev){var self=this;var $el=$(ev.currentTarget);var $i=$el.find('a i');var $p=$el.find('a p');var title=$p.text();var content='';var buttons;var moduleId=$el.data('module-id');var name=$el.data('module-shortdesc');ev.stopPropagation();ev.preventDefault();if(this.pendingInstall){content=this.newContentText.installInProgress;}else{content=_.str.sprintf(this.newContentText.installNeeded,name);buttons=[{text:_t("Install"),classes:'btn-primary',close:true,click:function(){var $finalPosition=self.$newContentMenuChoices.find('.o_new_content_element:not([data-module-id])').filter(function(){return $(this).data('original-index')<$el.data('original-index');}).last();if($finalPosition){$el.fadeTo(400,0,function(){$el.insertAfter($finalPosition);$i.removeClass().addClass('fa fa-spin fa-spinner fa-pulse');$p.removeClass('text-muted').text(_.str.sprintf(self.newContentText.installPleaseWait,name));$el.fadeTo(1000,1);});}
self._install(moduleId).then(function(){window.location.href=window.location.origin+window.location.pathname+'?'+enableFlag;},function(){$i.removeClass().addClass('fa fa-exclamation-triangle');$p.text(_.str.sprintf(self.newContentText.failed,name));});}},{text:_t("Cancel"),close:true,}];}
new Dialog(this,{title:title,size:'medium',$content:$('<p/>',{text:content}),buttons:buttons}).open();},});websiteNavbarData.websiteNavbarRegistry.add(NewContentMenu,'.o_new_content_menu');return NewContentMenu;});;

/* /website/static/src/js/menu/seo.js defined in bundle 'website.assets_editor' */
odoo.define('website.seo',function(require){'use strict';var core=require('web.core');var Class=require('web.Class');var Dialog=require('web.Dialog');var mixins=require('web.mixins');var rpc=require('web.rpc');var Widget=require('web.Widget');var weContext=require('web_editor.context');var weWidgets=require('web_editor.widget');var websiteNavbarData=require('website.navbar');var _t=core._t;var WORD_SEPARATORS_REGEX='([\\u2000-\\u206F\\u2E00-\\u2E7F\'!"#\\$%&\\(\\)\\*\\+,\\-\\.\\/:;<=>\\?¿¡@\\[\\]\\^_`\\{\\|\\}~\\s]+|^|$)';var Suggestion=Widget.extend({template:'website.seo_suggestion',xmlDependencies:['/website/static/src/xml/website.seo.xml'],events:{'click .js_seo_suggestion':'select',},init:function(parent,options){this.keyword=options.keyword;this._super(parent);},select:function(){this.trigger('selected',this.keyword);},});var SuggestionList=Widget.extend({template:'website.seo_suggestion_list',xmlDependencies:['/website/static/src/xml/website.seo.xml'],init:function(parent,options){this.root=options.root;this.language=options.language;this.htmlPage=options.htmlPage;this._super(parent);},start:function(){this.refresh();},refresh:function(){var self=this;self.$el.append(_t("Loading..."));var language=self.language||weContext.get().lang.toLowerCase();this._rpc({route:'/website/seo_suggest',params:{keywords:self.root,lang:language,},}).then(function(keyword_list){self.addSuggestions(JSON.parse(keyword_list));});},addSuggestions:function(keywords){var self=this;self.$el.empty();var regex=new RegExp(WORD_SEPARATORS_REGEX+self.root+WORD_SEPARATORS_REGEX,'gi');keywords=_.map(_.uniq(keywords),function(word){return word.replace(regex,'').trim();});_.each(keywords,function(keyword){if(keyword){var suggestion=new Suggestion(self,{keyword:keyword,});suggestion.on('selected',self,function(word,language){self.trigger('selected',word,language);});suggestion.appendTo(self.$el);}});},});var Keyword=Widget.extend({template:'website.seo_keyword',xmlDependencies:['/website/static/src/xml/website.seo.xml'],events:{'click a[data-action=remove-keyword]':'destroy',},init:function(parent,options){this.keyword=options.word;this.language=options.language;this.htmlPage=options.htmlPage;this.used_h1=this.htmlPage.isInHeading1(this.keyword);this.used_h2=this.htmlPage.isInHeading2(this.keyword);this.used_content=this.htmlPage.isInBody(this.keyword);this._super(parent);},start:function(){this.$('.js_seo_keyword_suggestion').empty();this.suggestionList=new SuggestionList(this,{root:this.keyword,language:this.language,htmlPage:this.htmlPage,});this.suggestionList.on('selected',this,function(word,language){this.trigger('selected',word,language);});this.suggestionList.appendTo(this.$('.js_seo_keyword_suggestion'));this.htmlPage.on('title-changed',this,this._updateTitle);this.htmlPage.on('description-changed',this,this._updateDescription);this._updateTitle();this._updateDescription();},destroy:function(){this.trigger('removed');this._super();},_updateTitle:function(){var $title=this.$('.js_seo_keyword_title');if(this.htmlPage.isInTitle(this.keyword)){$title.css('visibility','visible');}else{$title.css('visibility','hidden');}},_updateDescription:function(){var $description=this.$('.js_seo_keyword_description');if(this.htmlPage.isInDescription(this.keyword)){$description.css('visibility','visible');}else{$description.css('visibility','hidden');}},});var KeywordList=Widget.extend({template:'website.seo_list',xmlDependencies:['/website/static/src/xml/website.seo.xml'],maxKeywords:10,init:function(parent,options){this.htmlPage=options.htmlPage;this._super(parent);},start:function(){var self=this;var existingKeywords=self.htmlPage.keywords();if(existingKeywords.length>0){_.each(existingKeywords,function(word){self.add.call(self,word);});}},keywords:function(){var result=[];this.$('.js_seo_keyword').each(function(){result.push($(this).data('keyword'));});return result;},isFull:function(){return this.keywords().length>=this.maxKeywords;},exists:function(word){return _.contains(this.keywords(),word);},add:function(candidate,language){var self=this;var word=candidate?candidate.replace(/[,;.:<>]+/g,' ').replace(/ +/g,' ').trim().toLowerCase():'';if(word&&!self.isFull()&&!self.exists(word)){var keyword=new Keyword(self,{word:word,language:language,htmlPage:this.htmlPage,});keyword.on('removed',self,function(){self.trigger('list-not-full');self.trigger('content-updated',true);});keyword.on('selected',self,function(word,language){self.trigger('selected',word,language);});keyword.appendTo(self.$el);}
if(self.isFull()){self.trigger('list-full');}
self.trigger('content-updated');},});var Preview=Widget.extend({template:'website.seo_preview',xmlDependencies:['/website/static/src/xml/website.seo.xml'],init:function(parent,options){this.title=options.title;this.url=options.url;this.description=options.description||_t("The description will be generated by search engines based on page content unless you specify one.");if(this.description.length>160){this.description=this.description.substring(0,159)+'…';}
this._super(parent);},});var HtmlPage=Class.extend(mixins.PropertiesMixin,{init:function(){mixins.PropertiesMixin.init.call(this);this.initTitle=this.title();this.initDescription=this.description();},url:function(){return window.location.origin+window.location.pathname;},title:function(){return $('title').text().trim();},changeTitle:function(title){$('title').text(title.trim()||this.initTitle);this.trigger('title-changed',title);},description:function(){return($('meta[name=description]').attr('content')||'').trim();},changeDescription:function(description){$('meta[name=description]').attr('content',description);this.trigger('description-changed',description);},keywords:function(){var $keywords=$('meta[name=keywords]');var parsed=($keywords.length>0)&&$keywords.attr('content')&&$keywords.attr('content').split(',');return(parsed&&parsed[0])?parsed:[];},changeKeywords:function(keywords){$('meta[name=keywords]').attr('content',keywords.join(','));},headers:function(tag){return $('#wrap '+tag).map(function(){return $(this).text();});},getOgMeta:function(){var ogImageUrl=$('meta[property="og:image"]').attr('content');var title=$('meta[property="og:title"]').attr('content');var description=$('meta[property="og:description"]').attr('content');return{ogImageUrl:ogImageUrl&&ogImageUrl.replace(window.location.origin,''),metaTitle:title,metaDescription:description,};},images:function(){return $('#wrap img').map(function(){var $img=$(this);return{src:$img.attr('src'),alt:$img.attr('alt'),};});},company:function(){return $('html').attr('data-oe-company-name');},bodyText:function(){return $('body').children().not('.oe_seo_configuration').text();},heading1:function(){return $('body').children().not('.oe_seo_configuration').find('h1').text();},heading2:function(){return $('body').children().not('.oe_seo_configuration').find('h2').text();},isInBody:function(text){return new RegExp(WORD_SEPARATORS_REGEX+text+WORD_SEPARATORS_REGEX,'gi').test(this.bodyText());},isInTitle:function(text){return new RegExp(WORD_SEPARATORS_REGEX+text+WORD_SEPARATORS_REGEX,'gi').test(this.title());},isInDescription:function(text){return new RegExp(WORD_SEPARATORS_REGEX+text+WORD_SEPARATORS_REGEX,'gi').test(this.description());},isInHeading1:function(text){return new RegExp(WORD_SEPARATORS_REGEX+text+WORD_SEPARATORS_REGEX,'gi').test(this.heading1());},isInHeading2:function(text){return new RegExp(WORD_SEPARATORS_REGEX+text+WORD_SEPARATORS_REGEX,'gi').test(this.heading2());},});var MetaTitleDescription=Widget.extend({template:'website.seo_meta_title_description',xmlDependencies:['/website/static/src/xml/website.seo.xml'],events:{'input input[name=website_meta_title]':'_titleChanged','input textarea[name=website_meta_description]':'_descriptionOnInput','change textarea[name=website_meta_description]':'_descriptionOnChange',},maxRecommendedDescriptionSize:300,minRecommendedDescriptionSize:50,showDescriptionTooSmall:false,init:function(parent,options){this.htmlPage=options.htmlPage;this.canEditTitle=!!options.canEditTitle;this.canEditDescription=!!options.canEditDescription;this.isIndexed=!!options.isIndexed;this._super(parent,options);},start:function(){this.$title=this.$('input[name=website_meta_title]');this.$description=this.$('textarea[name=website_meta_description]');this.$warning=this.$('div#website_meta_description_warning');this.$preview=this.$('.js_seo_preview');this._renderPreview();if(!this.canEditTitle){this.$title.attr('disabled',true);}
if(!this.canEditDescription){this.$description.attr('disabled',true);}
this.$title.val(this.htmlPage.title());this.$description.val(this.htmlPage.description());this._descriptionOnChange();},getTitle:function(){return this.$title.val().trim()||this.htmlPage.initTitle;},getDescription:function(){return this.$description.val();},_titleChanged:function(){var self=this;self._renderPreview();self.trigger('title-changed');},_descriptionOnChange:function(){this.showDescriptionTooSmall=true;this._descriptionOnInput();},_descriptionOnInput:function(){var length=this.getDescription().length;if(length>=this.minRecommendedDescriptionSize){this.showDescriptionTooSmall=true;}else if(length===0){this.showDescriptionTooSmall=false;}
if(length>this.maxRecommendedDescriptionSize){this.$warning.text(_t('Your description looks too long.')).show();}else if(this.showDescriptionTooSmall&&length<this.minRecommendedDescriptionSize){this.$warning.text(_t('Your description looks too short.')).show();}else{this.$warning.hide();}
this._renderPreview();this.trigger('description-changed');},_renderPreview:function(){var indexed=this.isIndexed;var preview="";if(indexed){preview=new Preview(this,{title:this.getTitle(),description:this.getDescription(),url:this.htmlPage.url(),});}else{preview=new Preview(this,{description:_t("You have hidden this page from search results. It won't be indexed by search engines."),});}
this.$preview.empty();preview.appendTo(this.$preview);},});var MetaKeywords=Widget.extend({template:'website.seo_meta_keywords',xmlDependencies:['/website/static/src/xml/website.seo.xml'],events:{'keyup input[name=website_meta_keywords]':'_confirmKeyword','click button[data-action=add]':'_addKeyword',},init:function(parent,options){this.htmlPage=options.htmlPage;this._super(parent,options);},start:function(){var self=this;this.$input=this.$('input[name=website_meta_keywords]');this.keywordList=new KeywordList(this,{htmlPage:this.htmlPage});this.keywordList.on('list-full',this,function(){self.$input.attr({readonly:'readonly',placeholder:"Remove a keyword first"});self.$('button[data-action=add]').prop('disabled',true).addClass('disabled');});this.keywordList.on('list-not-full',this,function(){self.$input.removeAttr('readonly').attr('placeholder',"");self.$('button[data-action=add]').prop('disabled',false).removeClass('disabled');});this.keywordList.on('selected',this,function(word,language){self.keywordList.add(word,language);});this.keywordList.on('content-updated',this,function(removed){self._updateTable(removed);});this.keywordList.insertAfter(this.$('.table thead'));this._getLanguages();this._updateTable();},_addKeyword:function(){var $language=this.$('select[name=seo_page_language]');var keyword=this.$input.val();var language=$language.val().toLowerCase();this.keywordList.add(keyword,language);this.$input.val('').focus();},_confirmKeyword:function(e){if(e.keyCode===13){this._addKeyword();}},_getLanguages:function(){var self=this;this._rpc({model:'website',method:'get_languages',args:[[weContext.get().website_id]],}).then(function(data){self.$('#language-box').html(core.qweb.render('Configurator.language_promote',{'language':data,'def_lang':weContext.get().lang}));});},_updateTable:function(removed){var min=removed?1:0;if(this.keywordList.keywords().length>min){this.$('table').show();}else{this.$('table').hide();}},});var MetaImageSelector=Widget.extend({template:'website.seo_meta_image_selector',xmlDependencies:['/website/static/src/xml/website.seo.xml'],events:{'click .o_meta_img_upload':'_onClickUploadImg','click .o_meta_img':'_onClickSelectImg',},init:function(parent,data){this.metaTitle=data.title||'';this._setDescription(data.description);this.activeMetaImg=data.metaImg;this.serverUrl=data.htmlpage.url();data.pageImages.unshift(_.str.sprintf('/web/image/res.company/%s/logo',odoo.session_info.website_company_id));data.pageImages.unshift(_.str.sprintf('/web/image/website/%s/social_default_image',odoo.session_info.website_id));this.images=_.uniq(data.pageImages);this.customImgUrl=_.contains(data.pageImages,data.metaImg)?false:data.metaImg;this._super(parent);},setTitle:function(title){this.metaTitle=title;this._updateTemplateBody();},setDescription:function(description){this._setDescription(description);this._updateTemplateBody();},_setDescription:function(description){this.metaDescription=description||_t("The description will be generated by social media based on page content unless you specify one.");if(this.metaDescription.length>160){this.metaDescription=this.metaDescription.substring(0,159)+'…';}},_updateTemplateBody:function(){this.$el.empty();this.images=_.uniq(this.images);this.$el.append(core.qweb.render('website.og_image_body',{widget:this}));},_onClickSelectImg:function(ev){var $img=$(ev.currentTarget);this.activeMetaImg=$img.find('img').attr('src');this._updateTemplateBody();},_onClickUploadImg:function(ev){var self=this;var $image=$('<img/>');var mediaDialog=new weWidgets.MediaDialog(this,{onlyImages:true,res_model:'ir.ui.view',},null,$image);mediaDialog.open();mediaDialog.on('save',this,function(image){var src=image.attr('src');self.activeMetaImg=src;self.customImgUrl=src;self._updateTemplateBody();});},});var SeoConfigurator=Dialog.extend({template:'website.seo_configuration',xmlDependencies:Dialog.prototype.xmlDependencies.concat(['/website/static/src/xml/website.seo.xml']),canEditTitle:false,canEditDescription:false,canEditKeywords:false,canEditLanguage:false,init:function(parent,options){options=options||{};_.defaults(options,{title:_t('Optimize SEO'),buttons:[{text:_t('Save'),classes:'btn-primary',click:this.update},{text:_t('Discard'),close:true},],});this._super(parent,options);},start:function(){var self=this;this.$modal.addClass('oe_seo_configuration');this.htmlPage=new HtmlPage();this.disableUnsavableFields().then(function(){self.metaImageSelector=new MetaImageSelector(self,{htmlpage:self.htmlPage,title:self.htmlPage.getOgMeta().metaTitle,description:self.htmlPage.getOgMeta().metaDescription,metaImg:self.metaImg||self.htmlPage.getOgMeta().ogImageUrl,pageImages:_.pluck(self.htmlPage.images().get(),'src'),});self.metaImageSelector.appendTo(self.$('.js_seo_image'));self.metaTitleDescription=new MetaTitleDescription(self,{htmlPage:self.htmlPage,canEditTitle:self.canEditTitle,canEditDescription:self.canEditDescription,isIndexed:self.isIndexed,});self.metaTitleDescription.on('title-changed',self,self.titleChanged);self.metaTitleDescription.on('description-changed',self,self.descriptionChanged);self.metaTitleDescription.appendTo(self.$('.js_seo_meta_title_description'));self.metaKeywords=new MetaKeywords(self,{htmlPage:self.htmlPage});self.metaKeywords.appendTo(self.$('.js_seo_meta_keywords'));});},destroy:function(){if(!this.savedData){this.htmlPage.changeTitle(this.htmlPage.initTitle);this.htmlPage.changeDescription(this.htmlPage.initDescription);}
this._super.apply(this,arguments);},disableUnsavableFields:function(){var self=this;return this.loadMetaData().then(function(data){self.reloadOnSave=data.website_id===undefined?false:!data.website_id;self.isIndexed=(data&&('website_indexed'in data))?data.website_indexed:true;self.canEditTitle=data&&('website_meta_title'in data);self.canEditDescription=data&&('website_meta_description'in data);self.canEditKeywords=data&&('website_meta_keywords'in data);self.metaImg=data.website_meta_og_img;if(!self.canEditTitle&&!self.canEditDescription&&!self.canEditKeywords){self.$footer.find('button[data-action=update]').attr('disabled',true);}});},update:function(){var self=this;var data={};if(this.canEditTitle){data.website_meta_title=this.htmlPage.title();}
if(this.canEditDescription){data.website_meta_description=this.htmlPage.description();}
if(this.canEditKeywords){data.website_meta_keywords=this.metaKeywords.keywordList.keywords().join(', ');}
data.website_meta_og_img=this.metaImageSelector.activeMetaImg;this.saveMetaData(data).then(function(){if(self.reloadOnSave){window.location.href=self.htmlPage.url();}else{self.htmlPage.changeKeywords(self.metaKeywords.keywordList.keywords());self.savedData=true;self.close();}});},getMainObject:function(){var repr=$('html').data('main-object');var m=repr.match(/(.+)\((\d+),(.*)\)/);if(!m){return null;}else{return{model:m[1],id:m[2]|0};}},loadMetaData:function(){var obj=this.getMainObject();var def=$.Deferred();if(!obj){def.resolve(null);}else{var fields=['website_meta_title','website_meta_description','website_meta_keywords','website_meta_og_img'];if(obj.model==='website.page'){fields.push('website_indexed');fields.push('website_id');}
rpc.query({model:obj.model,method:'read',args:[[obj.id],fields],}).then(function(data){if(data.length){var meta=data[0];meta.model=obj.model;def.resolve(meta);}else{def.resolve(null);}}).fail(function(){def.reject();});}
return def;},saveMetaData:function(data){var obj=this.getMainObject();if(!obj){return $.Deferred().reject();}else{return this._rpc({model:obj.model,method:'write',args:[[obj.id],data],});}},titleChanged:function(){var self=this;_.defer(function(){var title=self.metaTitleDescription.getTitle();self.htmlPage.changeTitle(title);self.metaImageSelector.setTitle(title);});},descriptionChanged:function(){var self=this;_.defer(function(){var description=self.metaTitleDescription.getDescription();self.htmlPage.changeDescription(description);self.metaImageSelector.setDescription(description);});},});var SeoMenu=websiteNavbarData.WebsiteNavbarActionWidget.extend({actions:_.extend({},websiteNavbarData.WebsiteNavbarActionWidget.prototype.actions||{},{'promote-current-page':'_promoteCurrentPage',}),init:function(parent,options){this._super(parent,options);if($.deparam.querystring().enable_seo!==undefined){this._promoteCurrentPage();}},_promoteCurrentPage:function(){new SeoConfigurator(this).open();},});websiteNavbarData.websiteNavbarRegistry.add(SeoMenu,'#promote-menu');return{SeoConfigurator:SeoConfigurator,SeoMenu:SeoMenu,};});;

/* /website/static/src/js/menu/translate.js defined in bundle 'website.assets_editor' */
odoo.define('website.translateMenu',function(require){'use strict';var utils=require('web.utils');var weContext=require('web_editor.context');var translate=require('web_editor.translate');var websiteNavbarData=require('website.navbar');var ctx=weContext.getExtra();if(!ctx.translatable){return;}
var TranslatePageMenu=websiteNavbarData.WebsiteNavbarActionWidget.extend({actions:_.extend({},websiteNavbarData.WebsiteNavbar.prototype.actions||{},{edit_master:'_goToMasterPage',translate:'_startTranslateMode',}),start:function(){if(ctx.edit_translations){this._startTranslateMode();}
return this._super.apply(this,arguments);},_goToMasterPage:function(){var lang='/'+utils.get_cookie('frontend_lang');var current=document.createElement('a');current.href=window.location.toString();current.search+=(current.search?'&':'?')+'enable_editor=1';if(current.pathname.indexOf(lang)===0){current.pathname=current.pathname.replace(lang,'');}
var link=document.createElement('a');link.href='/website/lang/default';link.search+=(link.search?'&':'?')+'r='+encodeURIComponent(current.pathname+current.search+current.hash);window.location=link.href;return $.Deferred();},_startTranslateMode:function(){if(!ctx.edit_translations){window.location.search+='&edit_translations';return $.Deferred();}
var translator=new(translate.Class)(this,$('#wrapwrap'));return translator.prependTo(document.body);},});websiteNavbarData.websiteNavbarRegistry.add(TranslatePageMenu,'.o_menu_systray');});;

/* /website/static/src/js/tours/banner.js defined in bundle 'website.assets_editor' */
odoo.define("website.tour.banner",function(require){"use strict";var core=require("web.core");var tour=require("web_tour.tour");var base=require("web_editor.base");var _t=core._t;tour.register("banner",{url:"/",wait_for:base.ready(),},[{trigger:"a[data-action=edit]",content:_t("<b>Click Edit</b> to start designing your homepage."),extra_trigger:".homepage",position:"bottom",},{trigger:"#snippet_structure .oe_snippet:eq(1) .oe_snippet_thumbnail",content:_t("Drag the <i>Cover</i> block and drop it in your page."),position:"bottom",run:"drag_and_drop #wrap",},{trigger:"#wrapwrap .s_cover h1",content:_t("<b>Click on a text</b> to start editing it. <i>It's that easy to edit your content!</i>"),position:"left",width:150,run:"text",},{trigger:".oe_overlay_options .oe_options",extra_trigger:"#wrapwrap .s_cover h1:not(:containsExact(\"Catchy Headline\"))",content:_t("Customize any block through this menu. Try to change the background of the banner."),position:"bottom",},{trigger:"#snippet_structure .oe_snippet:eq(6) .oe_snippet_thumbnail",content:_t("Drag another block in your page, below the cover."),position:"bottom",run:"drag_and_drop #wrap",},{trigger:"button[data-action=save]",extra_trigger:".oe_overlay_options .oe_options",content:_t("Publish your page by clicking on the <b>Save</b> button."),position:"bottom",},{trigger:"a[data-action=show-mobile-preview]",content:_t("Good Job! You created your first page. Let's check how this page looks like on <b>mobile devices</b>."),position:"bottom",},{trigger:".modal-dialog:has(#mobile-viewport) button[data-dismiss=modal]",content:_t("After having checked how it looks on mobile, <b>close the preview</b>."),position:"right",},{trigger:"#new-content-menu > a",content:_t("<p><b>That's it.</b> Your homepage is live.</p><p>Continue adding more pages to your site or edit this page to make it even more awesome.</p>"),position:"bottom",}]);});odoo.define("website.tour.contact",function(require){"use strict";var core=require("web.core");var tour=require("web_tour.tour");var base=require("web_editor.base");var _t=core._t;tour.register("contact",{url:"/page/contactus",wait_for:base.ready(),},[{trigger:"li#customize-menu",content:_t("<b>Install a contact form</b> to improve this page."),extra_trigger:"#o_contact_mail",position:"bottom",},{trigger:"li#install_apps",content:_t("<b>Install new apps</b> to get more features. Let's install the <i>'Contact form'</i> app."),position:"bottom",}]);});;

/* /website/static/src/js/tours/customize.js defined in bundle 'website.assets_editor' */
odoo.define('website.tour.customize',function(require){'use strict';var core=require('web.core');var tour=require('web_tour.tour');var base=require('web_editor.base');var _t=core._t;tour.register('theme_customize',{url:'/',wait_for:base.ready(),},[{trigger:'button.o_theme_customize_color_primary, button.o_theme_customize_color_alpha',content:_t("Click here to choose your main branding color.<br/>It will recompute the palette with suggested matching colors."),position:'bottom',}]);});;

/* /website/static/src/js/tours/rte.js defined in bundle 'website.assets_editor' */
odoo.define('website.tour.rte',function(require){'use strict';var tour=require('web_tour.tour');var base=require('web_editor.base');tour.register('rte_translator',{test:true,url:'/',wait_for:base.ready(),},[{content:"click on Add a language",trigger:'.js_language_selector a:has(i.fa)',},{content:"select french",trigger:'select[name="lang"]',run:'text "fr_BE"',},{content:"load french",trigger:'.modal-footer button:first',extra_trigger:'.modal select[name="lang"]:propValueContains(fr_BE)',},{content:"click language dropdown",trigger:'.js_language_selector .dropdown-toggle',timeout:60000,},{content:"go to english version",trigger:'.js_language_selector a[data-lang="en_US"]',extra_trigger:'html[lang*="fr"]',},{content:"Open new page menu",trigger:'#new-content-menu > a',extra_trigger:'a[data-action="edit"]',},{content:"click on new page",trigger:'a[data-action="new_page"]',},{content:"insert page name",trigger:'#editor_new_page input[type="text"]',run:'text rte_translator',},{content:"create page",trigger:'button.btn-continue',extra_trigger:'input[type="text"]:propValue(rte_translator)',},{content:"drop a snippet",trigger:"#snippet_structure .oe_snippet:eq(1) .oe_snippet_thumbnail",run:'drag_and_drop #wrap',},{content:"change content",trigger:'.oe_overlay_options .oe_options:visible',run:function(){$("#wrap p:first").replaceWith('<p>Write one or <font style="background-color: yellow;">two paragraphs <b>describing</b></font> your product or\
                <font style="color: rgb(255, 0, 0);">services</font>. To be successful your content needs to be\
                useful to your <a href="/999">readers</a>.</p> <input placeholder="test translate placeholder"/>\
                <p>&lt;b&gt;&lt;/b&gt; is an HTML&nbsp;tag &amp; is empty</p>');$("#wrap img").attr("title","test translate image title");}},{content:"save",trigger:'button[data-action=save]',extra_trigger:'#wrap p:first b',},{content:"click language dropdown",trigger:'.js_language_selector .dropdown-toggle',},{content:"click on french version",trigger:'.js_language_selector a[data-lang="fr_BE"]',extra_trigger:'html[lang*="en"]:not(:has(button[data-action=save]))',},{content:"translate",trigger:'html:not(:has(#wrap p span)) .o_menu_systray a[data-action="translate"]',},{content:"close modal",trigger:'.modal-footer .btn-secondary',},{content:"check if translation is activate",trigger:'[data-oe-translation-id]',},{content:"translate text",trigger:'#wrap p font:first',run:function(action_helper){action_helper.text('translated french text');this.$anchor.trigger('keydown');},},{content:"translate text with special char",trigger:'#wrap input + p span:first',run:function(action_helper){action_helper.click();this.$anchor.prepend('&lt;{translated}&gt;').trigger('keydown');},},{content:"click on input",trigger:'#wrap input:first',extra_trigger:'#wrap .o_dirty font:first:contains(translated french text)',run:'click',},{content:"translate placeholder",trigger:'input:first',run:'text test french placeholder',},{content:"close modal",trigger:'.modal-footer .btn-primary',extra_trigger:'.modal input:propValue(test french placeholder)',},{content:"save translation",trigger:'button[data-action=save]',},{content:"check: content is translated",trigger:'#wrap p font:first:contains(translated french text)',run:function(){},},{content:"check: content with special char is translated",trigger:"#wrap input + p:contains(<{translated}><b></b> is an HTML\xa0tag & )",run:function(){},},{content:"check: placeholder translation",trigger:'input[placeholder="test french placeholder"]',run:function(){},},{content:"click language dropdown",trigger:'.js_language_selector .dropdown-toggle',},{content:"return to english version",trigger:'.js_language_selector a[data-lang="en_US"]',extra_trigger:'html[lang*="fr"]:not(:has(#wrap p span))',},{content:"edit english version",trigger:'a[data-action=edit]',extra_trigger:'body:not(:has(#wrap p font:first:containsExact(paragraphs <b>describing</b>)))',},{content:"select text",extra_trigger:'button[data-action=save]',trigger:'#wrap p',run:function(action_helper){action_helper.click();var el=this.$anchor[0];var evt=document.createEvent("MouseEvents");$.summernote.core.range.create(el.childNodes[2],6,el.childNodes[2],13).select();evt.initMouseEvent('mouseup',true,true,window,0,0,0,0,0,false,false,false,false,0,el);el.dispatchEvent(evt);},},{content:"underline",trigger:'.note-air-popover button[data-event="underline"]',},{content:"save new change",trigger:'button[data-action=save]',extra_trigger:'#wrap p u',},{content:"click language dropdown",trigger:'.js_language_selector .dropdown-toggle',},{content:"return in french",trigger:'html[lang="en-US"] .js_language_selector a[data-lang="fr_BE"]',extra_trigger:'html[lang*="en"]:not(:has(button[data-action=save]))',},{content:"check bis: content is translated",trigger:'#wrap p font:first:contains(translated french text)',extra_trigger:'body:not(:has(button[data-action=save]))',},{content:"check bis: placeholder translation",trigger:'input[placeholder="test french placeholder"]',},{content:"Open customize menu",trigger:"#customize-menu > .dropdown-toggle",},{content:"Open HTML editor",trigger:"[data-action='ace']",},{content:"Check that the editor is not showing translated content (1)",trigger:'.ace_text-layer .ace_line:contains("an HTML")',run:function(actions){var lineEscapedText=$(this.$anchor.text()).text();if(lineEscapedText!=="&lt;b&gt;&lt;/b&gt; is an HTML&nbsp;tag &amp; is empty"){console.error('The HTML editor should display the correct untranslated content');$('body').addClass('rte_translator_error');}},},{content:"Check that the editor is not showing translated content (2)",trigger:'body:not(.rte_translator_error)',run:function(){},}]);});;

/* /website/static/src/js/widgets/ace.js defined in bundle 'website.assets_editor' */
odoo.define("website.ace",function(require){"use strict";var AceEditor=require('web_editor.ace');var weContext=require('web_editor.context');var WebsiteAceEditor=AceEditor.extend({hash:'#advanced-view-editor',do_hide:function(){this._super.apply(this,arguments);window.location.hash="";},_displayResource:function(){this._super.apply(this,arguments);this._updateHash();},_saveResources:function(){return this._super.apply(this,arguments).then((function(){var defs=[];if(this.currentType==='xml'){var selectedView=_.findWhere(this.views,{id:this._getSelectedResource()});var context=weContext.get();defs.push(this._rpc({model:'ir.ui.view',method:'search_read',fields:['id'],domain:[['key','=',selectedView.key],['website_id','=',context.website_id]],}).then((function(view){if(view[0]){this._updateHash(view[0].id);}}).bind(this)));}
return $.when.apply($,defs).then((function(){window.location.reload();return $.Deferred();}));}).bind(this));},_resetResource:function(){return this._super.apply(this,arguments).then((function(){window.location.reload();return $.Deferred();}).bind(this));},_updateHash:function(resID){window.location.hash=this.hash+"?res="+(resID||this._getSelectedResource());},});return WebsiteAceEditor;});;

/* /website/static/src/js/widgets/theme.js defined in bundle 'website.assets_editor' */
odoo.define('website.theme',function(require){'use strict';var config=require('web.config');var core=require('web.core');var ColorpickerDialog=require('web.colorpicker');var Dialog=require('web.Dialog');var widgets=require('web_editor.widget');var websiteNavbarData=require('website.navbar');var _t=core._t;var templateDef=null;var ThemeCustomizeDialog=Dialog.extend({xmlDependencies:(Dialog.prototype.xmlDependencies||[]).concat(['/website/static/src/xml/website.editor.xml']),template:'website.theme_customize',events:{'change [data-xmlid], [data-enable], [data-disable]':'_onChange','click .checked [data-xmlid], .checked [data-enable], .checked [data-disable]':'_onChange','click .o_theme_customize_color':'_onColorClick',},init:function(parent,options){options=options||{};this._super(parent,_.extend({title:_t("Customize this theme"),buttons:[],},options));this.defaultTab=options.tab||0;},willStart:function(){if(templateDef===null){templateDef=this._rpc({model:'ir.ui.view',method:'read_template',args:['website.theme_customize'],}).then(function(data){return core.qweb.add_template(data);});}
return $.when(this._super.apply(this,arguments),templateDef);},start:function(){var self=this;this._generateDialogHTML();this.$modal.addClass('o_theme_customize_modal');var $tabs=this.$('[data-toggle="tab"]');this.opened().then(function(){$tabs.eq(self.defaultTab).tab('show');var $colorPreview=self.$('.o_theme_customize_color_previews:visible');var $primary=$colorPreview.find('.o_theme_customize_color[data-color="primary"]');var $alpha=$colorPreview.find('.o_theme_customize_color[data-color="alpha"]');var $secondary=$colorPreview.find('.o_theme_customize_color[data-color="secondary"]');var $beta=$colorPreview.find('.o_theme_customize_color[data-color="beta"]');var sameAlphaPrimary=$primary.find('.o_color_preview').css('background-color')===$alpha.find('.o_color_preview').css('background-color');var sameBetaSecondary=$secondary.find('.o_color_preview').css('background-color')===$beta.find('.o_color_preview').css('background-color');if(!sameAlphaPrimary){$alpha.find('.o_color_name').text(_t("Extra Color"));$primary.removeClass('d-none').addClass('d-flex');}
if(!sameBetaSecondary){$beta.find('.o_color_name').text(_t("Extra Color"));$secondary.removeClass('d-none').addClass('d-flex');}
if(!sameAlphaPrimary&&sameBetaSecondary){$beta.insertBefore($alpha);}else if(sameAlphaPrimary&&!sameBetaSecondary){$secondary.insertAfter($alpha);}});if($tabs.length<=1){$tabs.closest('.nav').addClass('d-none');}
this.$inputs=this.$('[data-xmlid], [data-enable], [data-disable]');return $.when(this._super.apply(this,arguments),this._loadViews());},_generateDialogHTML:function(){var $contents=this.$el.children('content');if($contents.length===0){return;}
$contents.remove();this.$el.append(core.qweb.render('website.theme_customize_modal_layout'));var $navLinksContainer=this.$('.nav');var $navContents=this.$('.tab-content');_.each($contents,function(content){var $content=$(content);var contentID=_.uniqueId('content-');$navLinksContainer.append($('<li/>',{class:'nav-item mb-1',}).append($('<a/>',{href:'#'+contentID,class:'nav-link','data-toggle':'tab',text:$content.attr('string'),})));var $navContent=$(core.qweb.render('website.theme_customize_modal_content',{id:contentID,title:$content.attr('title'),}));$navContents.append($navContent);var $optionsContainer=$navContent.find('.o_options_container');_processItems($content.children(),$optionsContainer);});this.$('[title]').tooltip();function _processItems($items,$container){var optionsName=_.uniqueId('option-');_.each($items,function(item){var $item=$(item);var $col;switch(item.tagName){case'OPT':var colorPalette=$item.data('colorPalette')==='user';var icon=$item.data('icon');var $multiChoiceLabel=$(core.qweb.render('website.theme_customize_modal_option',{name:optionsName,id:$item.attr('id')||_.uniqueId('o_theme_customize_input_id_'),string:$item.attr('string'),icon:icon,color:$item.data('color'),font:$item.data('font'),colorPalette:colorPalette,xmlid:$item.data('xmlid'),enable:$item.data('enable'),disable:$item.data('disable'),reload:$item.data('reload'),}));$multiChoiceLabel.find('.o_theme_customize_color[data-color="primary"]').addClass('d-none').removeClass('d-flex');$multiChoiceLabel.find('.o_theme_customize_color[data-color="secondary"]').addClass('d-none').removeClass('d-flex');if($container.hasClass('form-row')){$col=$('<div/>',{class:(icon?'col-4':(colorPalette?'col-12':'col-6'))});$col.append($multiChoiceLabel);$container.append($col);}else{$container.append($multiChoiceLabel);}
break;case'MORE':var collapseID=_.uniqueId('collapse-');$col=$('<div/>',{class:'col-12',}).appendTo($container);var string=$item.attr('string');if(string){var $button=$('<button/>',{'type':'button',class:'btn btn-primary d-block mx-auto mt-3 collapsed','data-toggle':'collapse','data-target':"#"+collapseID,text:string,});$col.append($button);}
var $collapse=$('<div/>',{id:collapseID,class:'collapse form-row justify-content-between mt-3','data-depends':$item.data('depends'),});$col.append($collapse);_processItems($item.children(),$collapse);break;case'LIST':var $listContainer=$('<div/>',{class:'py-1 px-2 o_theme_customize_option_list'});$col=$('<div/>',{class:'col-6 mt-2','data-depends':$item.data('depends'),}).append($('<h6/>',{text:$item.attr('string')}),$listContainer);$container.append($col);_processItems($item.children(),$listContainer);break;}});}},_loadViews:function(){var self=this;return this._rpc({route:'/website/theme_customize_get',params:{xml_ids:this._getXMLIDs(this.$inputs),},}).done(function(data){self.$inputs.prop('checked',false);_.each(self.$inputs.filter('[data-xmlid]:not([data-xmlid=""])'),function(input){var $input=$(input);if(!_.difference(self._getXMLIDs($input),data[0]).length){$input.prop('checked',true);}});_.each(self.$inputs.filter('[data-xmlid=""]'),function(input){var $input=$(input);if(!self.$inputs.filter('[name="'+$input.attr('name')+'"]:checked').length){$input.prop('checked',true);}});self._setActive();}).fail(function(d,error){Dialog.alert(this,error.data.message);});},_getInputs:function(string){if(!string){return $();}
return this.$inputs.filter('#'+string.replace(/\s*,\s*/g,', #'));},_getXMLIDs:function($inputs){var xmlIDs=[];_.each($inputs,function(input){var $input=$(input);var xmlID=$input.data('xmlid');if(xmlID){xmlIDs=xmlIDs.concat(xmlID.split(/\s*,\s*/));}});return xmlIDs;},_processChange:function($inputs){var self=this;this.$modal.addClass('o_theme_customize_loading');var bodyCustomImageXMLID='option_custom_body_image';var $inputBodyCustomImage=$inputs.filter('[data-xmlid*="website.'+bodyCustomImageXMLID+'"]:checked');if(!$inputBodyCustomImage.length){return $.when();}
var def=$.Deferred();var $image=$('<img/>');var editor=new widgets.MediaDialog(this,{onlyImages:true,firstFilters:['background']},null,$image[0]);editor.on('save',this,function(media){var src=$(media).attr('src');self._rpc({model:'ir.model.data',method:'get_object_reference',args:['website',bodyCustomImageXMLID],}).then(function(data){return self._rpc({model:'ir.ui.view',method:'save',args:[data[1],'#wrapwrap { background-image: url("'+src+'"); }','//style',],});}).then(function(){def.resolve();});});editor.on('cancel',this,function(){def.resolve();});editor.open();return def;},_setActive:function(){var self=this;var $enable=this.$inputs.filter('[data-xmlid]:checked');this.$('label').removeClass('checked');$enable.closest('label').addClass('checked');var $sets=this.$inputs.filter('[data-enable], [data-disable]').not('[data-xmlid]');_.each($sets,function(set){var $set=$(set);var checked=true;if(self._getInputs($set.data('enable')).not(':checked').length){checked=false;}
if(self._getInputs($set.data('disable')).filter(':checked').length){checked=false;}
$set.prop('checked',checked).closest('label').toggleClass('checked',checked);});var $collapsedElements=this.$('[data-depends]');_.each($collapsedElements,function(collapsed){var $collapsed=$(collapsed);var enabled=false;var nbDependencies=$collapsed.data('depends')?$collapsed.data('depends').split(',').length:0;if(self._getInputs($collapsed.data('depends')).filter(':checked').length===nbDependencies){enabled=true;}
if($collapsed.is('.collapse')){$collapsed.collapse(enabled?'show':'hide');}else{$collapsed.toggleClass('d-none',!enabled);}});},_updateStyle:function(enable,disable,reload){if(reload||config.debug==='assets'){window.location.href=$.param.querystring('/website/theme_customize_reload',{href:window.location.href,enable:enable.join(','),disable:disable.join(','),tab:this.$('.nav-link.active').parent().index(),});return $.Deferred();}
var self=this;return this._rpc({route:'/website/theme_customize',params:{enable:enable,disable:disable,get_bundle:true,},}).then(function(bundles){var defs=_.map(bundles,function(bundleContent,bundleName){var linkSelector='link[href*="'+bundleName+'"]';var $links=$(linkSelector);var $newLinks=$(bundleContent).filter(linkSelector);var linksLoaded=$.Deferred();var nbLoaded=0;$newLinks.on('load',function(e){if(++nbLoaded>=$newLinks.length){linksLoaded.resolve();}});$newLinks.on('error',function(e){linksLoaded.reject();window.location.hash='theme=true';window.location.reload();});$links.last().after($newLinks);return linksLoaded.then(function(){$links.remove();});});return $.when.apply($,defs).then(function(){self.$modal.removeClass('o_theme_customize_loading');});});},_onChange:function(ev){var self=this;var $option=$(ev.currentTarget);var $options=$option;var checked=$option.is(':checked');if(checked){var $inputs;$inputs=this._getInputs($option.data('enable'));$options=$options.add($inputs.filter(':not(:checked)'));$inputs.prop('checked',true);$inputs=this._getInputs($option.data('disable'));$options=$options.add($inputs.filter(':checked'));$inputs.prop('checked',false);}
var optionNames=_.uniq(_.map($options,function(option){return option.name;}));$options=this.$inputs.filter(function(i,input){return _.contains(optionNames,input.name);});var $enable=$options.filter('[data-xmlid]:checked');var $disable=$options.filter('[data-xmlid]:not(:checked)');this._setActive();self._processChange($options).then(function(){self._updateStyle(self._getXMLIDs($enable),self._getXMLIDs($disable),$option.data('reload')&&window.location.href.match(new RegExp($option.data('reload'))));});},_onColorClick:function(ev){var self=this;var $color=$(ev.currentTarget);var colorName=$color.data('color');var colorType=$color.data('colorType');var colorpicker=new ColorpickerDialog(this,{defaultColor:$color.find('.o_color_preview').css('background-color'),});colorpicker.on('colorpicker:saved',this,function(ev){ev.stopPropagation();self._rpc({route:'/web_editor/get_assets_editor_resources',params:{key:'website.layout',get_views:false,get_scss:true,bundles:false,bundles_restriction:[],},}).then(function(data){var files=data.scss[0][1];var file=_.find(files,function(file){var baseURL='/website/static/src/scss/options/colors/';return file.url===_.str.sprintf('%suser_%scolor_palette.scss',baseURL,(colorType?(colorType+'_'):''));});var colors={};colors[colorName]=ev.data.cssColor;if(colorName==='alpha'){colors['beta']='null';colors['gamma']='null';colors['delta']='null';colors['epsilon']='null';}
var updatedFileContent=file.arch;_.each(colors,function(colorValue,colorName){var pattern=_.str.sprintf("'%s': %%s,\n",colorName);var regex=new RegExp(_.str.sprintf(pattern,".+"));var replacement=_.str.sprintf(pattern,colorValue);if(regex.test(updatedFileContent)){updatedFileContent=updatedFileContent.replace(regex,replacement);}else{updatedFileContent=updatedFileContent.replace(/( *)(.*hook.*)/,_.str.sprintf('$1%s$1$2',replacement));}});return self._rpc({route:'/web_editor/save_scss',params:{url:file.url,bundle_xmlid:'web.assets_common',content:updatedFileContent,},});}).then(function(){self.$('#'+$color.closest('.o_theme_customize_color_previews').data('depends')).click();});});colorpicker.open();},});var ThemeCustomizeMenu=websiteNavbarData.WebsiteNavbarActionWidget.extend({actions:_.extend({},websiteNavbarData.WebsiteNavbarActionWidget.prototype.actions||{},{customize_theme:'_openThemeCustomizeDialog',}),start:function(){if((window.location.hash||'').indexOf('theme=true')>0){var tab=window.location.hash.match(/tab=(\d+)/);this._openThemeCustomizeDialog(tab?tab[1]:false);window.location.hash='';}
return this._super.apply(this,arguments);},_openThemeCustomizeDialog:function(tab){return new ThemeCustomizeDialog(this,{tab:tab}).open();},});websiteNavbarData.websiteNavbarRegistry.add(ThemeCustomizeMenu,'#theme_customize');return ThemeCustomizeDialog;});;

/* /website_twitter/static/src/js/website.twitter.editor.js defined in bundle 'website.assets_editor' */
odoo.define('website_twitter.editor',function(require){'use strict';var core=require('web.core');var dom=require('web.dom');var sOptions=require('web_editor.snippets.options');var _t=core._t;sOptions.registry.twitter=sOptions.Class.extend({start:function(){var self=this;var $configuration=dom.renderButton({attrs:{class:'btn-primary d-none',contenteditable:'false',},text:_t("Reload"),});$configuration.appendTo(document.body).on('click',function(ev){ev.preventDefault();ev.stopPropagation();self._rpc({route:'/website_twitter/reload'});});this.$target.on('mouseover.website_twitter',function(){var $selected=$(this);var position=$selected.offset();$configuration.removeClass('d-none').offset({top:$selected.outerHeight()/2
+position.top
-$configuration.outerHeight()/2,left:$selected.outerWidth()/2
+position.left
-$configuration.outerWidth()/2,});}).on('mouseleave.website_twitter',function(e){var current=document.elementFromPoint(e.clientX,e.clientY);if(current===$configuration[0]){return;}
$configuration.addClass('d-none');});this.$target.on('click.website_twitter','.lnk_configure',function(e){window.location=e.currentTarget.href;});this.trigger_up('animation_stop_demand',{$target:this.$target,});return this._super.apply(this,arguments);},cleanForSave:function(){this.$target.find('.twitter_timeline').empty();},destroy:function(){this._super.apply(this,arguments);this.$target.off('.website_twitter');},});});;

/* /website_event/static/src/js/website_event.editor.js defined in bundle 'website.assets_editor' */
odoo.define('website_event.editor',function(require){"use strict";var core=require('web.core');var wUtils=require('website.utils');var WebsiteNewMenu=require('website.newMenu');var _t=core._t;WebsiteNewMenu.include({actions:_.extend({},WebsiteNewMenu.prototype.actions||{},{new_event:'_createNewEvent',}),_createNewEvent:function(){var self=this;return wUtils.prompt({id:"editor_new_event",window_title:_t("New Event"),input:_t("Event Name"),}).then(function(eventName){if(!eventName){return;}
return self._rpc({route:'/event/add_event',params:{event_name:eventName,},}).then(function(url){window.location.href=url;return $.Deferred();});});},});});;

/* /website_event/static/src/js/website.tour.event.js defined in bundle 'website.assets_editor' */
odoo.define("website_event.tour",function(require){"use strict";var core=require("web.core");var tour=require("web_tour.tour");var base=require("web_editor.base");var _t=core._t;tour.register("event",{url:"/",wait_for:base.ready(),},[tour.STEPS.WEBSITE_NEW_PAGE,{trigger:"a[data-action=new_event]",content:_t("Click here to create a new event."),position:"bottom",},{trigger:'.modal-dialog #editor_new_event input[type=text]',content:_t("Create a name for your new event and click <em>\"Continue\"</em>. e.g: Technical Training"),position:"right",},{trigger:'.modal-footer button.btn-primary.btn-continue',extra_trigger:'#editor_new_event input[type=text][value!=""]',content:_t("Click <em>Continue</em> to create the event."),position:"right",},{trigger:"#snippet_structure .oe_snippet:eq(2) .oe_snippet_thumbnail",content:_t("Drag this block and drop it in your page."),position:"bottom",run:"drag_and_drop",},{trigger:"button[data-action=save]",content:_t("Once you click on save, your event is updated."),position:"bottom",},{trigger:".js_publish_management .js_publish_btn",extra_trigger:"body:not(.editor_enable)",content:_t("Click to publish your event."),position:"top",},{trigger:".css_edit_dynamic",extra_trigger:".js_publish_management .js_publish_btn .css_unpublish:visible",content:_t("Click here to customize your event further."),position:"bottom",}]);});;

/* /website_mail_channel/static/src/js/website_mail_channel.editor.js defined in bundle 'website.assets_editor' */
odoo.define('website_mail_channel.editor',function(require){'use strict';var core=require('web.core');var rpc=require('web.rpc');var weContext=require('web_editor.context');var options=require('web_editor.snippets.options');var wUtils=require('website.utils');var _t=core._t;options.registry.subscribe=options.Class.extend({select_mailing_list:function(previewMode,value){var self=this;return wUtils.prompt({id:"editor_new_subscribe_button",window_title:_t("Add a Subscribe Button"),select:_t("Discussion List"),init:function(field){return rpc.query({model:'mail.channel',method:'name_search',args:['',[['public','=','public']]],context:weContext.get(),});},}).then(function(mail_channel_id){self.$target.attr("data-id",mail_channel_id);});},onBuilt:function(){var self=this;this._super();this.select_mailing_list("click").fail(function(){self.getParent().removeSnippet();});},cleanForSave:function(){this.$target.addClass('d-none');},});});